//
// ChemDoodle Web Components 4.6.1
//
// http://web.chemdoodle.com
//
// Copyright 2009 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact> for
// alternate licensing options.
//
var ChemDoodle=function(){return{structures:{},iChemLabs:{},informatics:{},io:{},getVersion:function(){return"4.6.1"}}}();
(function(c,b,a,e,f){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1";b.inRelay=!1;b.asynchronous=!0;b.INFO={userAgent:navigator.userAgent,v_cwc:c.getVersion(),v_jQuery:f.version,v_jQuery_ui:f.ui?f.ui.version:"N/A"};b.contactServer=function(a,e,d,c){this.inRelay?alert("Already connecting to the server, please wait for the first request to finish."):(b.inRelay=!0,f.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:e,info:b.INFO}),url:this.SERVER_URL,success:function(a){b.inRelay=
!1;o=JSON.parse(a);o.message&&alert(o.message);null!=d&&o.content&&!o.stop&&d(o.content);o.stop&&null!=c&&c()},error:function(){b.inRelay=!1;alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)");null!=c&&c()},beforeSend:function(a){a.withCredentials=!0},async:b.asynchronous}))};b.optimize=function(g,e,d,b){this.contactServer("optimize",{mol:a.toJSONDummy(g),dimension:e},function(b){b=a.fromJSONDummy(b.mol);if(2==e){for(var c=0,f=b.atoms.length;c<
f;c++)g.atoms[c].x=b.atoms[c].x,g.atoms[c].y=b.atoms[c].y;d()}else if(3==e){c=0;for(f=b.atoms.length;c<f;c++)b.atoms[c].x/=20,b.atoms[c].y/=20,b.atoms[c].z/=20;d(b)}},b)};b.readSMILES=function(g,b,d){this.contactServer("readSMILES",{smiles:g},function(d){b(a.fromJSONDummy(d.mol))},d)};b.writeSMILES=function(g,b,d){this.contactServer("writeSMILES",{mol:a.toJSONDummy(g)},function(a){b(a.smiles)},d)};b.saveFile=function(g,b,d,e){this.contactServer("saveFile",{mol:a.toJSONDummy(g),ext:b},function(a){d(a.link)},
e)};b.getMoleculeFromDatabase=function(g,b,d,e,c){this.contactServer("getMoleculeFromDatabase",{database:g,dimension:e?e:2,query:b},function(g){if(3==e)for(var b=0,c=g.mol.a.length;b<c;b++)g.mol.a[b].x/=20,g.mol.a[b].y/=-20,g.mol.a[b].z/=20;d(a.fromJSONDummy(g.mol))},c)};b.getMoleculeFromContent=function(a,b,d,e){this.contactServer("getMoleculeFromContent",{content:a,format:b},function(a){for(var g=!1,b=0,e=a.mol.a.length;b<e;b++)if(0!=a.mol.a[b].z){g=!0;break}if(g){b=0;for(e=a.mol.a.length;b<e;b++)a.mol.a[b].x/=
20,a.mol.a[b].y/=20,a.mol.a[b].z/=20}d(ChemDoodle.io.fromJSONDummy(a.mol))},e)};b.calculate=function(b,e,d,c){this.contactServer("calculate",{mol:a.toJSONDummy(b),descriptors:e},function(a){d(a)},c)};b.simulate1HNMR=function(b,e,d){this.contactServer("simulateNMR",{mol:a.toJSONDummy(b),nucleus:"H",isotope:1},function(a){e(c.readJCAMP(a.jcamp))},d)};b.simulate13CNMR=function(b,e,d){this.contactServer("simulateNMR",{mol:a.toJSONDummy(b),nucleus:"C",isotope:13},function(a){e(c.readJCAMP(a.jcamp))},d)};
b.simulateMassParentPeak=function(b,e,d){this.contactServer("simulateMassParentPeak",{mol:a.toJSONDummy(b)},function(a){e(c.readJCAMP(a.jcamp))},d)};b.getOptimizedPDBStructure=function(b,c,d,f){this.contactServer("getOptimizedPDBStructure",{id:b,withAtoms:c},function(b){var g=null,g=b.mol?a.fromJSONDummy(b.mol):new e.Molecule;g.chains=a.fromJSONChains(b.ribbons);g.fromJSON=!0;d(g)},f)};b.getAd=function(a,b){this.contactServer("getAd",{},function(b){a(b.image_url,b.target_url)},b)};b.kekulize=function(b,
e,d){this.contactServer("kekulize",{mol:a.toJSONDummy(b)},function(b){e(a.fromJSONDummy(b.mol))},d)};b.isGraphIsomorphism=function(b,e,d,c){this.contactServer("isGraphIsomorphism",{arrow:a.toJSONDummy(b),target:a.toJSONDummy(e)},function(a){d(a.value)},c)};b.isSubgraphIsomorphism=function(b,e,d,c){this.contactServer("isSubgraphIsomorphism",{arrow:a.toJSONDummy(b),target:a.toJSONDummy(e)},function(a){d(a.value)},c)};b.readIUPACName=function(b,e,d){this.contactServer("readIUPACName",{iupac:b},function(b){e(a.fromJSONDummy(b.mol))},
d)};b.generateImage=function(b,e,d,c){this.contactServer("generateImage",{mol:a.toJSONDummy(b),ext:e},function(a){d(a.link)},c)};b.getZeoliteFromIZA=function(a,b,d,e,c,f){this.contactServer("getZeoliteFromIZA",{query:a},function(a){b(ChemDoodle.readCIF(a.cif,d,e,c))},f)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);
ChemDoodle.extensions=function(c,b,a){return{stringStartsWith:function(a,b){return a.match("^"+b)==b},vec3AngleFrom:function(e,c){var g=b.length(e),h=b.length(c),g=b.dot(e,c)/g/h;return a.acos(g)},contextHashTo:function(a,b,g,h,d,k,q){for(var p=0,r=(new c.Point(b,g)).distance(new c.Point(h,d)),l=!1,m=b,j=g,b=h-b,g=d-g;p<r;){if(l)if(p+q>r){a.moveTo(h,d);break}else{var t=q/r,m=m+t*b,j=j+t*g;a.moveTo(m,j);p+=q}else if(p+k>r){a.lineTo(h,d);break}else t=k/r,m+=t*b,j+=t*g,a.lineTo(m,j),p+=k;l=!l}},contextRoundRect:function(a,
b,c,h,d,k){a.beginPath();a.moveTo(b+k,c);a.lineTo(b+h-k,c);a.quadraticCurveTo(b+h,c,b+h,c+k);a.lineTo(b+h,c+d-k);a.quadraticCurveTo(b+h,c+d,b+h-k,c+d);a.lineTo(b+k,c+d);a.quadraticCurveTo(b,c+d,b,c+d-k);a.lineTo(b,c+k);a.quadraticCurveTo(b,c,b+k,c);a.closePath()},contextEllipse:function(a,b,c,h,d){var k=0.5522848*(h/2),q=0.5522848*(d/2),p=b+h,r=c+d,h=b+h/2,d=c+d/2;a.beginPath();a.moveTo(b,d);a.bezierCurveTo(b,d-q,h-k,c,h,c);a.bezierCurveTo(h+k,c,p,d-q,p,d);a.bezierCurveTo(p,d+q,h+k,r,h,r);a.bezierCurveTo(h-
k,r,b,d+q,b,d);a.closePath()}}}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(c,b,a){var e={},f={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.angleBetweenLargest=function(b){if(0==b.length)return{angle:0,largest:2*a.PI};if(1==b.length)return{angle:b[0]+a.PI,largest:2*a.PI};for(var c=0,d=0,e=0,f=b.length-1;e<f;e++){var p=b[e+1]-b[e];
p>c&&(c=p,d=(b[e+1]+b[e])/2)}e=b[0]+2*a.PI-b[b.length-1];e>c&&(d=b[0]-e/2,c=e,0>d&&(d+=2*a.PI));return{angle:d,largest:c}};e.isBetween=function(a,b,d){return a>=b&&a<=d};e.getRGB=function(a,b){var d=[0,0,0];null!=f[a.toLowerCase()]&&(a=f[a.toLowerCase()]);if("#"==a.charAt(0))return 4==a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),[parseInt(a.substring(1,3),16)/255*b,parseInt(a.substring(3,5),16)/255*b,parseInt(a.substring(5,7),16)/255*b];if(c.stringStartsWith(a,
"rgb")){var e=a.replace(/rgb\(|\)/g,"").split(",");return 3!=e.length?d:[parseInt(e[0])/255*b,parseInt(e[1])/255*b,parseInt(e[2])/255*b]}return d};e.distanceFromPointToLineInclusive=function(c,f,d){var k=f.distance(d),d=f.angle(d),d=a.PI/2-d;new b.Point(c.x-f.x,c.y-f.x);new b.Point;d=f.angle(c)+d;c=f.distance(c);pcopRot=new b.Point(c*a.cos(d),-c*a.sin(d));return e.isBetween(-pcopRot.y,0,k)?a.abs(pcopRot.x):-1};e.hsl2rgb=function(a,b,c){if(0==b)c=b=a=c;else var e=function(a,b,c){0>c&&(c+=1);1<c&&(c-=
1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},f=0.5>c?c*(1+b):c+b-c*b,p=2*c-f,c=e(p,f,a+1/3),b=e(p,f,a),a=e(p,f,a-1/3);return[255*c,255*b,255*a]};return e}(ChemDoodle.extensions,ChemDoodle.structures,Math);
ChemDoodle.featureDetection=function(c,b,a,e){var f={supports_canvas:function(){return!!a.createElement("canvas").getContext},supports_canvas_text:function(){return!f.supports_canvas()?!1:"function"==typeof a.createElement("canvas").getContext("2d").fillText},supports_webgl:function(){var b=a.createElement("canvas");try{if(b.getContext("webgl")||b.getContext("experimental-webgl"))return!0}catch(c){}return!1},supports_xhr2:function(){return b.support.cors},supports_touch:function(){return"ontouchstart"in
e},supports_gesture:function(){return"ongesturestart"in e}};return f}(ChemDoodle.iChemLabs,jQuery,document,window);ChemDoodle.SYMBOLS="H,He,Li,Be,B,C,N,O,F,Ne,Na,Mg,Al,Si,P,S,Cl,Ar,K,Ca,Sc,Ti,V,Cr,Mn,Fe,Co,Ni,Cu,Zn,Ga,Ge,As,Se,Br,Kr,Rb,Sr,Y,Zr,Nb,Mo,Tc,Ru,Rh,Pd,Ag,Cd,In,Sn,Sb,Te,I,Xe,Cs,Ba,La,Ce,Pr,Nd,Pm,Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,W,Re,Os,Ir,Pt,Au,Hg,Tl,Pb,Bi,Po,At,Rn,Fr,Ra,Ac,Th,Pa,U,Np,Pu,Am,Cm,Bk,Cf,Es,Fm,Md,No,Lr,Rf,Db,Sg,Bh,Hs,Mt,Ds,Rg,Cn,Uut,Uuq,Uup,Uuh,Uus,Uuo".split(",");
ChemDoodle.ELEMENT=function(c){function b(a,b,c){this.symbol=a;this.name=b;this.atomicNumber=c;return!0}var a=[];a.H=new b("H","Hydrogen",1);a.He=new b("He","Helium",2);a.Li=new b("Li","Lithium",3);a.Be=new b("Be","Beryllium",4);a.B=new b("B","Boron",5);a.C=new b("C","Carbon",6);a.N=new b("N","Nitrogen",7);a.O=new b("O","Oxygen",8);a.F=new b("F","Fluorine",9);a.Ne=new b("Ne","Neon",10);a.Na=new b("Na","Sodium",11);a.Mg=new b("Mg","Magnesium",12);a.Al=new b("Al","Aluminum",13);a.Si=new b("Si","Silicon",
14);a.P=new b("P","Phosphorus",15);a.S=new b("S","Sulfur",16);a.Cl=new b("Cl","Chlorine",17);a.Ar=new b("Ar","Argon",18);a.K=new b("K","Potassium",19);a.Ca=new b("Ca","Calcium",20);a.Sc=new b("Sc","Scandium",21);a.Ti=new b("Ti","Titanium",22);a.V=new b("V","Vanadium",23);a.Cr=new b("Cr","Chromium",24);a.Mn=new b("Mn","Manganese",25);a.Fe=new b("Fe","Iron",26);a.Co=new b("Co","Cobalt",27);a.Ni=new b("Ni","Nickel",28);a.Cu=new b("Cu","Copper",29);a.Zn=new b("Zn","Zinc",30);a.Ga=new b("Ga","Gallium",
31);a.Ge=new b("Ge","Germanium",32);a.As=new b("As","Arsenic",33);a.Se=new b("Se","Selenium",34);a.Br=new b("Br","Bromine",35);a.Kr=new b("Kr","Krypton",36);a.Rb=new b("Rb","Rubidium",37);a.Sr=new b("Sr","Strontium",38);a.Y=new b("Y","Yttrium",39);a.Zr=new b("Zr","Zirconium",40);a.Nb=new b("Nb","Niobium",41);a.Mo=new b("Mo","Molybdenum",42);a.Tc=new b("Tc","Technetium",43);a.Ru=new b("Ru","Ruthenium",44);a.Rh=new b("Rh","Rhodium",45);a.Pd=new b("Pd","Palladium",46);a.Ag=new b("Ag","Silver",47);a.Cd=
new b("Cd","Cadmium",48);a.In=new b("In","Indium",49);a.Sn=new b("Sn","Tin",50);a.Sb=new b("Sb","Antimony",51);a.Te=new b("Te","Tellurium",52);a.I=new b("I","Iodine",53);a.Xe=new b("Xe","Xenon",54);a.Cs=new b("Cs","Cesium",55);a.Ba=new b("Ba","Barium",56);a.La=new b("La","Lanthanum",57);a.Ce=new b("Ce","Cerium",58);a.Pr=new b("Pr","Praseodymium",59);a.Nd=new b("Nd","Neodymium",60);a.Pm=new b("Pm","Promethium",61);a.Sm=new b("Sm","Samarium",62);a.Eu=new b("Eu","Europium",63);a.Gd=new b("Gd","Gadolinium",
64);a.Tb=new b("Tb","Terbium",65);a.Dy=new b("Dy","Dysprosium",66);a.Ho=new b("Ho","Holmium",67);a.Er=new b("Er","Erbium",68);a.Tm=new b("Tm","Thulium",69);a.Yb=new b("Yb","Ytterbium",70);a.Lu=new b("Lu","Lutetium",71);a.Hf=new b("Hf","Hafnium",72);a.Ta=new b("Ta","Tantalum",73);a.W=new b("W","Tungsten",74);a.Re=new b("Re","Rhenium",75);a.Os=new b("Os","Osmium",76);a.Ir=new b("Ir","Iridium",77);a.Pt=new b("Pt","Platinum",78);a.Au=new b("Au","Gold",79);a.Hg=new b("Hg","Mercury",80);a.Tl=new b("Tl",
"Thallium",81);a.Pb=new b("Pb","Lead",82);a.Bi=new b("Bi","Bismuth",83);a.Po=new b("Po","Polonium",84);a.At=new b("At","Astatine",85);a.Rn=new b("Rn","Radon",86);a.Fr=new b("Fr","Francium",87);a.Ra=new b("Ra","Radium",88);a.Ac=new b("Ac","Actinium",89);a.Th=new b("Th","Thorium",90);a.Pa=new b("Pa","Protactinium",91);a.U=new b("U","Uranium",92);a.Np=new b("Np","Neptunium",93);a.Pu=new b("Pu","Plutonium",94);a.Am=new b("Am","Americium",95);a.Cm=new b("Cm","Curium",96);a.Bk=new b("Bk","Berkelium",97);
a.Cf=new b("Cf","Californium",98);a.Es=new b("Es","Einsteinium",99);a.Fm=new b("Fm","Fermium",100);a.Md=new b("Md","Mendelevium",101);a.No=new b("No","Nobelium",102);a.Lr=new b("Lr","Lawrencium",103);a.Rf=new b("Rf","Rutherfordium",104);a.Db=new b("Db","Dubnium",105);a.Sg=new b("Sg","Seaborgium",106);a.Bh=new b("Bh","Bohrium",107);a.Hs=new b("Hs","Hassium",108);a.Mt=new b("Mt","Meitnerium",109);a.Ds=new b("Ds","Darmstadtium",110);a.Rg=new b("Rg","Roentgenium",111);a.Cn=new b("Cn","Copernicium",112);
a.Uut=new b("Uut","Ununtrium",113);a.Uuq=new b("Uuq","Ununquadium",114);a.Uup=new b("Uup","Ununpentium",115);a.Uuh=new b("Uuh","Ununhexium",116);a.Uus=new b("Uus","Ununseptium",117);a.Uuo=new b("Uuo","Ununoctium",118);a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor=
"#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor="#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";
a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor=
"#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor="#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";
a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor=
"#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor="#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor=
"#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";for(var e=0,f=c.length;e<f;e++)a[c[e]].pymolColor=a[c[e]].jmolColor;a.H.pymolColor="#E6E6E6";a.C.pymolColor="#33FF33";a.N.pymolColor="#3333FF";a.O.pymolColor="#FF4D4D";a.F.pymolColor="#B3FFFF";a.S.pymolColor="#E6C640";a.H.covalentRadius=0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;
a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=
1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=
1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;
a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=
2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;
a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=
0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=
1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=
0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=
0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=
0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=
0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=
0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=
9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=
102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;
a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(){function c(a,b){this.symbol=a;this.name=b;return!0}var b=[];b.Ala=new c("Ala","Alanine");b.Arg=new c("Arg","Arginine");b.Asn=new c("Asn","Asparagine");b.Asp=new c("Asp","Aspartic Acid");b.Cys=new c("Cys","Cysteine");b.Gln=new c("Gln","Glutamine");b.Glu=new c("Glu","Glutamic Acid");b.Gly=new c("Gly","Glycine");b.His=new c("His","Histidine");b.Ile=new c("Ile","Isoleucine");b.Leu=new c("Leu","Leucine");b.Lys=new c("Lys","Lysine");b.Met=new c("Met","Methionine");b.Phe=new c("Phe",
"Phenylalanine");b.Pro=new c("Pro","Proline");b.Ser=new c("Ser","Serine");b.Thr=new c("Thr","Threonine");b.Trp=new c("Trp","Tryptophan");b.Tyr=new c("Tyr","Tyrosine");b.Val=new c("Val","Valine");b.Asx=new c("Asx","Asparagine/Aspartic Acid");b.Glx=new c("Glx","Glutamine/Glutamic Acid");b["*"]=new c("*","Other");b.A=new c("A","Adenine");b.G=new c("G","Guanine");b.I=new c("I","");b.C=new c("C","Cytosine");b.T=new c("T","Thymine");b.U=new c("U","Uracil");b.Ala.polar=!1;b.Arg.polar=!0;b.Asn.polar=!0;b.Asp.polar=
!0;b.Cys.polar=!0;b.Gln.polar=!0;b.Glu.polar=!0;b.Gly.polar=!1;b.His.polar=!0;b.Ile.polar=!1;b.Leu.polar=!1;b.Lys.polar=!0;b.Met.polar=!1;b.Phe.polar=!1;b.Pro.polar=!1;b.Ser.polar=!0;b.Thr.polar=!0;b.Trp.polar=!0;b.Tyr.polar=!0;b.Val.polar=!1;b.Asx.polar=!0;b.Glx.polar=!0;b.Ala.aminoColor="#C8C8C8";b.Arg.aminoColor="#145AFF";b.Asn.aminoColor="#00DCDC";b.Asp.aminoColor="#E60A0A";b.Cys.aminoColor="#E6E600";b.Gln.aminoColor="#00DCDC";b.Glu.aminoColor="#E60A0A";b.Gly.aminoColor="#EBEBEB";b.His.aminoColor=
"#8282D2";b.Ile.aminoColor="#0F820F";b.Leu.aminoColor="#0F820F";b.Lys.aminoColor="#145AFF";b.Met.aminoColor="#E6E600";b.Phe.aminoColor="#3232AA";b.Pro.aminoColor="#DC9682";b.Ser.aminoColor="#FA9600";b.Thr.aminoColor="#FA9600";b.Trp.aminoColor="#B45AB4";b.Tyr.aminoColor="#3232AA";b.Val.aminoColor="#0F820F";b.Asx.aminoColor="#FF69B4";b.Glx.aminoColor="#FF69B4";b["*"].aminoColor="#BEA06E";b.A.aminoColor="#BEA06E";b.G.aminoColor="#BEA06E";b.I.aminoColor="#BEA06E";b.C.aminoColor="#BEA06E";b.T.aminoColor=
"#BEA06E";b.U.aminoColor="#BEA06E";b.Ala.shapelyColor="#8CFF8C";b.Arg.shapelyColor="#00007C";b.Asn.shapelyColor="#FF7C70";b.Asp.shapelyColor="#A00042";b.Cys.shapelyColor="#FFFF70";b.Gln.shapelyColor="#FF4C4C";b.Glu.shapelyColor="#660000";b.Gly.shapelyColor="#FFFFFF";b.His.shapelyColor="#7070FF";b.Ile.shapelyColor="#004C00";b.Leu.shapelyColor="#455E45";b.Lys.shapelyColor="#4747B8";b.Met.shapelyColor="#B8A042";b.Phe.shapelyColor="#534C52";b.Pro.shapelyColor="#525252";b.Ser.shapelyColor="#FF7042";b.Thr.shapelyColor=
"#B84C00";b.Trp.shapelyColor="#4F4600";b.Tyr.shapelyColor="#8C704C";b.Val.shapelyColor="#FF8CFF";b.Asx.shapelyColor="#FF00FF";b.Glx.shapelyColor="#FF00FF";b["*"].shapelyColor="#FF00FF";b.A.shapelyColor="#A0A0FF";b.G.shapelyColor="#FF7070";b.I.shapelyColor="#80FFFF";b.C.shapelyColor="#FF8C4B";b.T.shapelyColor="#A0FFA0";b.U.shapelyColor="#FF8080";return b}();
(function(c){c.Queue=function(){var b=[],a=0;this.getSize=function(){return b.length-a};this.isEmpty=function(){return 0==b.length};this.enqueue=function(a){b.push(a)};this.dequeue=function(){var c=void 0;b.length&&(c=b[a],2*++a>=b.length&&(b=b.slice(a),a=0));return c};this.getOldestElement=function(){var c=void 0;b.length&&(c=b[a]);return c}}})(ChemDoodle.structures);
(function(c,b){c.Point=function(a,c){this.x=a?a:0;this.y=c?c:0;this.sub=function(a){this.x-=a.x;this.y-=a.y};this.add=function(a){this.x+=a.x;this.y+=a.y};this.distance=function(a){var c=a.x-this.x,a=a.y-this.y;return b.sqrt(c*c+a*a)};this.angleForStupidCanvasArcs=function(a){for(var c=a.x-this.x,a=a.y-this.y,e=0,e=0==c?0==a?0:0<a?b.PI/2:3*b.PI/2:0==a?0<c?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>e;)e+=2*b.PI;return e%=2*b.PI};this.angle=function(a){for(var c=a.x-this.x,a=this.y-
a.y,e=0,e=0==c?0==a?0:0<a?b.PI/2:3*b.PI/2:0==a?0<c?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>e;)e+=2*b.PI;return e%=2*b.PI};return!0}})(ChemDoodle.structures,Math);
(function(c,b,a,e,f){a.Atom=function(a,h,d,k){this.x=h?h:0;this.y=d?d:0;this.z=k?k:0;this.numLonePair=this.charge=0;this.mass=-1;this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0;this.isHidden=!1;this.label=a?a.replace(/\s/g,""):"C";this.altLabel=null;c[this.label]||(this.label="C");this.isSelected=this.isHover=this.isLone=!1;this.add3D=function(a){this.x=this.x+a.x;this.y=this.y+a.y;this.z=this.z+a.z};this.sub3D=function(a){this.x=this.x-a.x;this.y=this.y-a.y;this.z=this.z-
a.z};this.distance3D=function(a){var b=a.x-this.x,c=a.y-this.y,a=a.z-this.z;return e.sqrt(b*b+c*c+a*a)};this.draw=function(a,d){if(this.specs)d=this.specs;var g=d.getFontString(d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=g;a.fillStyle=d.atoms_color;if(d.atoms_useJMOLColors)a.fillStyle=c[this.label].jmolColor;else if(d.atoms_usePYMOLColors)a.fillStyle=c[this.label].pymolColor;if(this.isLone&&!d.atoms_displayAllCarbonLabels_2D||d.atoms_circles_2D){a.beginPath();
a.arc(this.x,this.y,d.atoms_circleDiameter_2D/2,0,e.PI*2,false);a.fill();if(d.atoms_circleBorderWidth_2D>0){a.lineWidth=d.atoms_circleBorderWidth_2D;a.strokeStyle="black";a.stroke(this.x,this.y,0,e.PI*2,d.atoms_circleDiameter_2D/2)}}else if(this.isLabelVisible(d)){a.textAlign="center";a.textBaseline="middle";if(this.altLabel!=void 0)a.fillText(this.altLabel,this.x,this.y);else{a.fillText(this.label,this.x,this.y);if(this.mass!=-1){var f=a.measureText(this.label).width,k=d.getFontString(d.atoms_font_size_2D*
0.7,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),h=a.font;a.font=k;k=a.measureText(this.mass).width;a.fillText(this.mass,this.x-k-0.5,this.y-d.atoms_font_size_2D*0.3);a.font=h}h=this.getImplicitHydrogenCount();if(d.atoms_implicitHydrogens_2D&&h>0){var f=a.measureText(this.label).width,t=a.measureText("H").width;if(h>1){var u=f/2+t/2,n=0,k=d.getFontString(d.atoms_font_size_2D*0.8,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=k;var w=a.measureText(h).width;
if(this.bondNumber==1)this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(u=-f/2-w-t/2);else if(!(this.angleOfLeastInterference<=e.PI/4))if(this.angleOfLeastInterference<3*e.PI/4){u=0;n=-d.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=5*e.PI/4)u=-f/2-w-t/2;else if(this.angleOfLeastInterference<7*e.PI/4){u=0;n=d.atoms_font_size_2D*0.9}a.font=g;a.fillText("H",this.x+u,this.y+n);a.font=k;a.fillText(h,this.x+u+t/2+w/2,this.y+n+d.atoms_font_size_2D*0.3)}else{u=
f/2+t/2;n=0;if(this.bondNumber==1)this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(u=-f/2-t/2);else if(!(this.angleOfLeastInterference<=e.PI/4))if(this.angleOfLeastInterference<3*e.PI/4){u=0;n=-d.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=5*e.PI/4)u=-f/2-t/2;else if(this.angleOfLeastInterference<7*e.PI/4){u=0;n=d.atoms_font_size_2D*0.9}a.fillText("H",this.x+u,this.y+n)}}}if(this.charge!=0){g=this.charge.toFixed(0);g=g=="1"?"+":g=="-1"?"\u2013":b.stringStartsWith(g,
"-")?g.substring(1)+"\u2013":g+"+";k=this.angleOfLeastInterference;f=d.atoms_font_size_2D;this.isLabelVisible(d)&&h>0&&(k=k+e.PI/4);a.textAlign="center";a.textBaseline="middle";a.fillText(g,this.x+f*e.cos(k),this.y-f*e.sin(k))}if(this.numLonePair>0){a.fillStyle="black";if(this.bondNumber==2&&e.abs(this.largestAngle-e.PI)<e.PI/60){this.drawLonePairs(a,d,e.floor(this.numLonePair/2),this.angleOfLeastInterference,this.largestAngle);this.drawLonePairs(a,d,e.floor(this.numLonePair/2)+this.numLonePair%2,
this.angleOfLeastInterference+e.PI,this.largestAngle)}else this.drawLonePairs(a,d,this.numLonePair,this.angleOfLeastInterference,this.largestAngle)}}};this.drawLonePairs=function(a,b,c,d,g){for(var f=g/(c+(this.bondNumber==0?0:1)),g=d-g/2+f,k=0;k<c;k++){var d=g+k*f,h=this.x+Math.cos(d)*b.atoms_lonePairDistance_2D,n=this.y-Math.sin(d)*b.atoms_lonePairDistance_2D,w=d+Math.PI/2,d=Math.cos(w)*b.atoms_lonePairSpread_2D/2,w=-Math.sin(w)*b.atoms_lonePairSpread_2D/2;a.beginPath();a.arc(h+d,n+w,b.atoms_lonePairDiameter_2D,
0,e.PI*2,false);a.fill();a.beginPath();a.arc(h-d,n-w,b.atoms_lonePairDiameter_2D,0,e.PI*2,false);a.fill()}};this.drawDecorations=function(a){if(this.isHover||this.isSelected){a.strokeStyle=this.isHover?"#885110":"#0060B2";a.lineWidth=1.2;a.beginPath();a.arc(this.x,this.y,this.isHover?7:15,0,e.PI*2,false);a.stroke()}};this.render=function(a,b){if(this.specs)b=this.specs;var d=f.translate(a.modelViewMatrix,[this.x,this.y,this.z],[]),e=b.atoms_useVDWDiameters_3D?c[this.label].vdWRadius*b.atoms_vdwMultiplier_3D:
b.atoms_sphereDiameter_3D/2;e==0&&(e=1);f.scale(d,[e,e,e]);e=b.atoms_color;if(b.atoms_useJMOLColors)e=c[this.label].jmolColor;else if(b.atoms_usePYMOLColors)e=c[this.label].pymolColor;a.material.setDiffuseColor(e);a.setMatrixUniforms(d);a.drawElements(a.TRIANGLES,(this.renderAsStar?a.starBuffer:a.sphereBuffer).vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)};this.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||this.label!="C"||this.altLabel||this.mass!=-1||this.charge!=0||this.numLonePair!=
0||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber==1};this.getImplicitHydrogenCount=function(){if(this.label=="H"||c[this.label]==null)return 0;var a=c[this.label].valency,b=a-this.coordinationNumber;if(this.charge>0){a=4-a;b=this.charge<=a?b+this.charge:4-this.coordinationNumber-this.charge+a}else b=b+this.charge;return b<0?0:b};return!0};a.Atom.prototype=new a.Point(0,0)})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4);
(function(c,b,a,e,f,g){a.Bond=function(h,d,k){this.a1=h;this.a2=d;this.bondOrder=k?k:1;this.stereo=a.Bond.STEREO_NONE;this.isHover=!1;this.ring=null;this.getCenter=function(){return new a.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};this.getLength=function(){return this.a1.distance(this.a2)};this.getLength3D=function(){return this.a1.distance3D(this.a2)};this.contains=function(a){return a==this.a1||a==this.a2};this.getNeighbor=function(a){return a==this.a1?this.a2:a==this.a2?this.a1:null};
this.draw=function(d,g){this.specs&&(g=this.specs);var f=this.a1.x,k=this.a2.x,h=this.a1.y,j=this.a2.y,t=k-f,u=j-h;g.atoms_display&&!g.atoms_circles_2D&&this.a1.isLabelVisible(g)&&(f+=t*g.bonds_atomLabelBuffer_2D,h+=u*g.bonds_atomLabelBuffer_2D);g.atoms_display&&!g.atoms_circles_2D&&this.a2.isLabelVisible(g)&&(k-=t*g.bonds_atomLabelBuffer_2D,j-=u*g.bonds_atomLabelBuffer_2D);if(g.bonds_clearOverlaps_2D){var n=f+0.15*t,w=h+0.15*u,v=k-0.15*t,x=j-0.15*u;d.strokeStyle=g.backgroundColor;d.lineWidth=g.bonds_width_2D+
2*g.bonds_overlapClearWidth_2D;d.lineCap="round";d.beginPath();d.moveTo(n,w);d.lineTo(v,x);d.closePath();d.stroke()}d.strokeStyle=g.bonds_color;d.fillStyle=g.bonds_color;d.lineWidth=g.bonds_width_2D;d.lineCap=g.bonds_ends_2D;if(g.bonds_useJMOLColors||g.bonds_usePYMOLColors)n=d.createLinearGradient(f,h,k,j),w=c[this.a1.label].jmolColor,v=c[this.a2.label].jmolColor,g.atoms_usePYMOLColors&&(w=c[this.a1.label].pymolColor,v=c[this.a2.label].pymolColor),n.addColorStop(0,w),g.bonds_colorGradient||(n.addColorStop(0.5,
w),n.addColorStop(0.51,v)),n.addColorStop(1,v),d.strokeStyle=n,d.fillStyle=n;switch(this.bondOrder){case 0.5:d.beginPath();d.moveTo(f,h);b.contextHashTo(d,f,h,k,j,g.bonds_hashSpacing_2D,g.bonds_hashSpacing_2D);d.stroke();break;case 1:if(this.stereo==a.Bond.STEREO_PROTRUDING||this.stereo==a.Bond.STEREO_RECESSED){var A=g.bonds_width_2D/2,u=this.a1.distance(this.a2)*g.bonds_wedgeThickness_2D/2,n=this.a1.angle(this.a2)+e.PI/2,w=e.cos(n),n=e.sin(n),t=f-w*A,v=h+n*A,x=f+w*A,A=h-n*A,D=k+w*u,C=j-n*u,w=k-w*
u,n=j+n*u;d.beginPath();d.moveTo(t,v);d.lineTo(x,A);d.lineTo(D,C);d.lineTo(w,n);d.closePath();this.stereo==a.Bond.STEREO_PROTRUDING?d.fill():(d.save(),d.clip(),d.lineWidth=2*u,d.lineCap="butt",d.beginPath(),d.moveTo(f,h),b.contextHashTo(d,f,h,k,j,g.bonds_hashWidth_2D,g.bonds_hashSpacing_2D),d.stroke(),d.restore())}else if(this.stereo==a.Bond.STEREO_AMBIGUOUS){d.beginPath();d.moveTo(f,h);j=e.floor(e.sqrt(t*t+u*u)/g.bonds_wavyLength_2D);n=this.a1.angle(this.a2)+e.PI/2;w=e.cos(n);n=e.sin(n);k=t/j;u/=
j;for(D=0;D<j;D++)f+=k,h+=u,t=g.bonds_wavyLength_2D*w+f-0.5*k,x=g.bonds_wavyLength_2D*-n+h-0.5*u,v=g.bonds_wavyLength_2D*-w+f-0.5*k,A=g.bonds_wavyLength_2D*n+h-0.5*u,0==D%2?d.quadraticCurveTo(t,x,f,h):d.quadraticCurveTo(v,A,f,h);d.stroke();break}else d.beginPath(),d.moveTo(f,h),d.lineTo(k,j),d.stroke();break;case 1.5:d.beginPath();d.moveTo(f,h);d.lineTo(k,j);d.stroke();break;case 2:this.stereo==a.Bond.STEREO_AMBIGUOUS?(u=this.a1.distance(this.a2)*g.bonds_saturationWidth_2D/2,n=this.a1.angle(this.a2)+
e.PI/2,t=f-e.cos(n)*u,v=h+e.sin(n)*u,x=f+e.cos(n)*u,A=h-e.sin(n)*u,D=k+e.cos(n)*u,C=j-e.sin(n)*u,w=k-e.cos(n)*u,n=j+e.sin(n)*u,d.beginPath(),d.moveTo(t,v),d.lineTo(D,C),d.moveTo(x,A),d.lineTo(w,n),d.stroke()):!g.bonds_symmetrical_2D&&(null!=this.ring||"C"==this.a1.label&&"C"==this.a2.label)?(d.beginPath(),d.moveTo(f,h),d.lineTo(k,j),w=0,v=this.a1.distance(this.a2),t=this.a1.angle(this.a2),n=t+e.PI/2,u=v*g.bonds_saturationWidth_2D,x=g.bonds_saturationAngle_2D,x<e.PI/2&&(w=-(u/e.tan(x))),e.abs(w)<v/
2&&(x=f-e.cos(t)*w,f=k+e.cos(t)*w,k=h+e.sin(t)*w,h=j-e.sin(t)*w,t=x-e.cos(n)*u,v=k+e.sin(n)*u,x+=e.cos(n)*u,A=k-e.sin(n)*u,D=f-e.cos(n)*u,C=h+e.sin(n)*u,w=f+e.cos(n)*u,n=h-e.sin(n)*u,null==this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>e.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-e.PI?(d.moveTo(t,v),d.lineTo(D,C)):(d.moveTo(x,A),d.lineTo(w,n)),d.stroke())):(u=this.a1.distance(this.a2)*
g.bonds_saturationWidth_2D/2,n=this.a1.angle(this.a2)+e.PI/2,t=f-e.cos(n)*u,v=h+e.sin(n)*u,x=f+e.cos(n)*u,A=h-e.sin(n)*u,D=k+e.cos(n)*u,C=j-e.sin(n)*u,w=k-e.cos(n)*u,n=j+e.sin(n)*u,d.beginPath(),d.moveTo(t,v),d.lineTo(w,n),d.moveTo(x,A),d.lineTo(D,C),d.stroke());break;case 3:u=this.a1.distance(this.a2)*g.bonds_saturationWidth_2D,n=this.a1.angle(this.a2)+e.PI/2,t=f-e.cos(n)*u,v=h+e.sin(n)*u,x=f+e.cos(n)*u,A=h-e.sin(n)*u,D=k+e.cos(n)*u,C=j-e.sin(n)*u,w=k-e.cos(n)*u,n=j+e.sin(n)*u,d.beginPath(),d.moveTo(t,
v),d.lineTo(w,n),d.moveTo(x,A),d.lineTo(D,C),d.moveTo(f,h),d.lineTo(k,j),d.stroke()}};this.drawDecorations=function(a){if(this.isHover||this.isSelected){var b=2*e.PI,d=(this.a1.angleForStupidCanvasArcs(this.a2)+e.PI/2)%b;a.strokeStyle=this.isHover?"#885110":"#0060B2";a.lineWidth=1.2;a.beginPath();var c=(d+e.PI)%b,c=c%(2*e.PI);a.arc(this.a1.x,this.a1.y,7,d,c,!1);a.stroke();a.beginPath();d+=e.PI;c=(d+e.PI)%b;a.arc(this.a2.x,this.a2.y,7,d,c,!1);a.stroke()}};this.render=function(a,d){this.specs&&(d=this.specs);
var k=(d.bonds_renderAsLines_3D?1.1:1.001)*this.a1.distance3D(this.a2)/(d.bonds_useJMOLColors||d.bonds_usePYMOLColors?2:1);if(0==k)return!1;var k=[d.bonds_cylinderDiameter_3D/2,k,d.bonds_cylinderDiameter_3D/2],h=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),m=null,j=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(d.bonds_useJMOLColors||d.bonds_usePYMOLColors)g.scale(j,0.5),m=f.translate(a.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]);var t=[0],u=null;if(d.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:t=
[-d.bonds_cylinderDiameter_3D,d.bonds_cylinderDiameter_3D];break;case 3:t=[-1.2*d.bonds_cylinderDiameter_3D,0,1.2*d.bonds_cylinderDiameter_3D]}if(1<t.length){var u=[0,0,1],n=f.inverse(a.rotationMatrix,[]);f.multiplyVec3(n,u);u=g.cross(j,u,[]);g.normalize(u)}}var w=[0,1,0],n=0,v=null;this.a1.x==this.a2.x&&this.a1.z==this.a2.z?(v=[0,0,1],this.a2.y<this.a1.y&&(n=e.PI)):(n=b.vec3AngleFrom(w,j),v=g.cross(w,j,[]));j=0;for(w=t.length;j<w;j++){var x=f.set(h,[]);0!=t[j]&&f.translate(x,g.scale(u,t[j],[]));
0!=n&&f.rotate(x,n,v);f.scale(x,k);var A=d.bonds_color;d.bonds_useJMOLColors?A=c[this.a1.label].jmolColor:d.bonds_usePYMOLColors&&(A=c[this.a1.label].pymolColor);a.material.setDiffuseColor(A);a.setMatrixUniforms(x);d.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems);if(d.bonds_useJMOLColors||d.bonds_usePYMOLColors)f.set(m,x),0!=t[j]&&f.translate(x,g.scale(u,t[j],[])),f.rotate(x,
n+e.PI,v),f.scale(x,k),a.material.setDiffuseColor(d.bonds_usePYMOLColors?c[this.a2.label].pymolColor:c[this.a2.label].jmolColor),a.setMatrixUniforms(x),d.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}};return!0};a.Bond.STEREO_NONE="none";a.Bond.STEREO_PROTRUDING="protruding";a.Bond.STEREO_RECESSED="recessed";a.Bond.STEREO_AMBIGUOUS="ambiguous"})(ChemDoodle.ELEMENT,ChemDoodle.extensions,
ChemDoodle.structures,Math,mat4,vec3);
(function(c,b){c.Ring=function(){this.atoms=[];this.bonds=[];this.center=null;this.setupBonds=function(){for(var a=0,b=this.bonds.length;a<b;a++)this.bonds[a].ring=this;this.center=this.getCenter()};this.getCenter=function(){for(var a=minY=Infinity,e=maxY=-Infinity,f=0,g=this.atoms.length;f<g;f++)a=b.min(this.atoms[f].x,a),minY=b.min(this.atoms[f].y,minY),e=b.max(this.atoms[f].x,e),maxY=b.max(this.atoms[f].y,maxY);return new c.Point((e+a)/2,(maxY+minY)/2)};return!0}})(ChemDoodle.structures,Math);
(function(c,b,a,e,f){a.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[];this.findRings=!0;this.draw=function(a,b){this.specs&&(b=this.specs);if(b.bonds_display)for(var d=0,c=this.bonds.length;d<c;d++)this.bonds[d].draw(a,b);if(b.atoms_display){d=0;for(c=this.atoms.length;d<c;d++)this.atoms[d].draw(a,b)}};this.render=function(b,c){this.specs&&(c=this.specs);var d=0<this.atoms.length&&void 0!=this.atoms[0].hetatm;if(d){if(c.macro_displayBonds){0<this.bonds.length&&(c.bonds_renderAsLines_3D&&
!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(b.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:c.bonds_width_2D),b.lineBuffer.bindBuffers(b)):b.cylinderBuffer.bindBuffers(b),b.material.setTempColors(c.bonds_materialAmbientColor_3D,null,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));for(var f=0,q=this.bonds.length;f<q;f++){var p=this.bonds[f];if(!p.a1.hetatm&&(-1==c.macro_atomToLigandDistance||void 0!=p.a1.closestDistance&&c.macro_atomToLigandDistance>=
p.a1.closestDistance&&c.macro_atomToLigandDistance>=p.a2.closestDistance))p.render(b,this.residueSpecs?this.residueSpecs:c)}}if(c.macro_displayAtoms){0<this.atoms.length&&(b.sphereBuffer.bindBuffers(b),b.material.setTempColors(c.atoms_materialAmbientColor_3D,null,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));f=0;for(q=this.atoms.length;f<q;f++){var r=this.atoms[f];if(!r.hetatm&&(-1==c.macro_atomToLigandDistance||void 0!=r.closestDistance&&c.macro_atomToLigandDistance>=r.closestDistance))r.render(b,
this.residueSpecs?this.residueSpecs:c)}}}if(c.bonds_display){0<this.bonds.length&&(c.bonds_renderAsLines_3D?(b.lineWidth(c.bonds_width_2D),b.lineBuffer.bindBuffers(b)):b.cylinderBuffer.bindBuffers(b),b.material.setTempColors(c.bonds_materialAmbientColor_3D,null,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));f=0;for(q=this.bonds.length;f<q;f++)p=this.bonds[f],(!d||p.a1.hetatm)&&p.render(b,c)}if(c.atoms_display){f=0;for(q=this.atoms.length;f<q;f++)r=this.atoms[f],r.bondNumber=0,r.renderAsStar=
!1;f=0;for(q=this.bonds.length;f<q;f++)p=this.bonds[f],p.a1.bondNumber++,p.a2.bondNumber++;0<this.atoms.length&&(b.sphereBuffer.bindBuffers(b),b.material.setTempColors(c.atoms_materialAmbientColor_3D,null,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));p=[];f=0;for(q=this.atoms.length;f<q;f++)if(r=this.atoms[f],!d||r.hetatm&&(c.macro_showWater||!r.isWater))c.atoms_nonBondedAsStars_3D&&0==r.bondNumber?(r.renderAsStar=!0,p.push(r)):r.render(b,c);if(0<p.length){b.starBuffer.bindBuffers(b);
f=0;for(q=p.length;f<q;f++)p[f].render(b,c)}}if(this.chains){b.setMatrixUniforms(b.modelViewMatrix);if(c.proteins_displayRibbon){b.material.setTempColors(c.proteins_materialAmbientColor_3D,null,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);d=0;for(r=this.ribbons.length;d<r;d++)if(c.proteins_useShapelyColors||c.proteins_useAminoColors||c.proteins_usePolarityColors){p=c.proteins_ribbonCartoonize?this.cartoons[d]:this.ribbons[d];p.front.bindBuffers(b);f=0;for(q=p.front.segments.length;f<
q;f++)p.front.segments[f].render(b,c);p.back.bindBuffers(b);f=0;for(q=p.back.segments.length;f<q;f++)p.back.segments[f].render(b,c)}else if(c.proteins_ribbonCartoonize){p=this.cartoons[d];p.front.bindBuffers(b);f=0;for(q=p.front.cartoonSegments.length;f<q;f++)p.front.cartoonSegments[f].render(b,c);p.back.bindBuffers(b);f=0;for(q=p.back.cartoonSegments.length;f<q;f++)p.back.cartoonSegments[f].render(b,c)}else p=this.ribbons[d],p.front.render(b,c),p.back.render(b,c)}if(c.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace=
{nodes:[],edges:[]};d=0;for(r=this.chains.length;d<r;d++){var l=this.chains[d];if(!(2<l.length&&e[l[2].name]&&"#BEA06E"==e[l[2].name].aminoColor)&&0<l.length){f=1;for(q=l.length-2;f<q;f++)p=l[f].cp1,p.chainColor=l.chainColor,this.alphaCarbonTrace.nodes.push(p),p=new a.Bond(l[f].cp1,l[f+1].cp1),p.residueName=l[f].name,p.chainColor=l.chainColor,this.alphaCarbonTrace.edges.push(p),f==l.length-3&&(p=l[f+1].cp1,p.chainColor=l.chainColor,this.alphaCarbonTrace.nodes.push(p))}}}if(0<this.alphaCarbonTrace.nodes.length){d=
new a.VisualSpecifications;d.atoms_display=!0;d.bonds_display=!0;d.atoms_sphereDiameter_3D=c.proteins_backboneThickness;d.bonds_cylinderDiameter_3D=c.proteins_backboneThickness;d.bonds_useJMOLColors=!1;d.atoms_color=c.proteins_backboneColor;d.bonds_color=c.proteins_backboneColor;d.atoms_useVDWDiameters_3D=!1;b.material.setTempColors(c.proteins_materialAmbientColor_3D,null,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);b.material.setDiffuseColor(c.proteins_backboneColor);f=0;
for(q=this.alphaCarbonTrace.nodes.length;f<q;f++)p=this.alphaCarbonTrace.nodes[f],c.macro_colorByChain&&(d.atoms_color=p.chainColor),b.sphereBuffer.bindBuffers(b),p.render(b,d);f=0;for(q=this.alphaCarbonTrace.edges.length;f<q;f++)r=this.alphaCarbonTrace.edges[f],p=null,l=e[r.residueName]?e[r.residueName]:e["*"],c.macro_colorByChain?p=r.chainColor:c.proteins_useShapelyColors?p=l.shapelyColor:c.proteins_useAminoColors?p=l.aminoColor:c.proteins_usePolarityColors&&(p=l.polar?"#C10000":"#FFFFFF"),null!=
p&&(d.bonds_color=p),b.cylinderBuffer.bindBuffers(b),r.render(b,d)}}if(c.nucleics_display){b.material.setTempColors(c.nucleics_materialAmbientColor_3D,null,c.nucleics_materialSpecularColor_3D,c.nucleics_materialShininess_3D);d=0;for(r=this.tubes.length;d<r;d++)b.setMatrixUniforms(b.modelViewMatrix),p=this.tubes[d],p.render(b,c)}}c.crystals_displayUnitCell&&this.unitCell&&(b.setMatrixUniforms(b.modelViewMatrix),this.unitCell.bindBuffers(b),b.material.setDiffuseColor(c.crystals_unitCellColor),b.lineWidth(c.crystals_unitCellLineWidth),
b.drawElements(b.LINES,this.unitCell.vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0));this.surface&&c.surfaces_display&&(b.setMatrixUniforms(b.modelViewMatrix),this.surface.bindBuffers(b),b.material.setTempColors(c.surfaces_materialAmbientColor_3D,c.surfaces_color,c.surfaces_materialSpecularColor_3D,c.surfaces_materialShininess_3D),"Dot"==c.surfaces_style?b.drawArrays(b.POINTS,0,this.surface.vertexPositionBuffer.numItems):b.drawElements(b.TRIANGLES,this.surface.vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,
0))};this.getCenter3D=function(){if(1==this.atoms.length)return new a.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var b=minY=minZ=Infinity,c=maxY=maxZ=-Infinity;if(this.chains)for(var d=0,e=this.chains.length;d<e;d++)for(var q=this.chains[d],p=0,r=q.length;p<r;p++){var l=q[p],b=f.min(l.cp1.x,b);minY=f.min(l.cp1.y,minY);minZ=f.min(l.cp1.z,minZ);c=f.max(l.cp1.x,c);maxY=f.max(l.cp1.y,maxY);maxZ=f.max(l.cp1.z,maxZ);b=f.min(l.cp2.x,b);minY=f.min(l.cp2.y,minY);minZ=f.min(l.cp2.z,minZ);c=f.max(l.cp2.x,
c);maxY=f.max(l.cp2.y,maxY);maxZ=f.max(l.cp2.z,maxZ)}d=0;for(e=this.atoms.length;d<e;d++)b=f.min(this.atoms[d].x,b),minY=f.min(this.atoms[d].y,minY),minZ=f.min(this.atoms[d].z,minZ),c=f.max(this.atoms[d].x,c),maxY=f.max(this.atoms[d].y,maxY),maxZ=f.max(this.atoms[d].z,maxZ);return new a.Atom("C",(c+b)/2,(maxY+minY)/2,(maxZ+minZ)/2)};this.getCenter=function(){if(1==this.atoms.length)return new a.Point(this.atoms[0].x,this.atoms[0].y);for(var b=minY=Infinity,c=maxY=-Infinity,d=0,e=this.atoms.length;d<
e;d++)b=f.min(this.atoms[d].x,b),minY=f.min(this.atoms[d].y,minY),c=f.max(this.atoms[d].x,c),maxY=f.max(this.atoms[d].y,maxY);return new a.Point((c+b)/2,(maxY+minY)/2)};this.getDimension=function(){if(1==this.atoms.length)return new a.Point(0,0);var b=minY=Infinity,c=maxY=-Infinity;if(this.chains){for(var d=0,e=this.chains.length;d<e;d++)for(var q=this.chains[d],p=0,r=q.length;p<r;p++){var l=q[p],b=f.min(l.cp1.x,b);minY=f.min(l.cp1.y,minY);c=f.max(l.cp1.x,c);maxY=f.max(l.cp1.y,maxY);b=f.min(l.cp2.x,
b);minY=f.min(l.cp2.y,minY);c=f.max(l.cp2.x,c);maxY=f.max(l.cp2.y,maxY)}b-=30;minY-=30;minZ-=30;c+=30;maxY+=30;maxZ+=30}d=0;for(e=this.atoms.length;d<e;d++)b=f.min(this.atoms[d].x,b),minY=f.min(this.atoms[d].y,minY),c=f.max(this.atoms[d].x,c),maxY=f.max(this.atoms[d].y,maxY);return new a.Point(c-b,maxY-minY)};this.check=function(){if(this.findRings){this.rings=(new c.informatics.SSSRFinder(this)).rings;for(var a=0,b=this.bonds.length;a<b;a++)this.bonds[a].ring=null;a=0;for(b=this.rings.length;a<b;a++)this.rings[a].setupBonds()}a=
0;for(b=this.atoms.length;a<b;a++)if(this.atoms[a].isLone=!1,"C"==this.atoms[a].label){for(var d=0,e=0,f=this.bonds.length;e<f;e++)(this.bonds[e].a1==this.atoms[a]||this.bonds[e].a2==this.atoms[a])&&d++;0==d&&(this.atoms[a].isLone=!0)}d=!1;a=0;for(b=this.atoms.length;a<b;a++)0!=this.atoms[a].z&&(d=!0);d&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData()};this.getAngles=function(a){for(var b=[],c=0,e=this.bonds.length;c<e;c++)this.bonds[c].contains(a)&&b.push(a.angle(this.bonds[c].getNeighbor(a)));
b.sort();return b};this.getCoordinationNumber=function(a){for(var b=0,c=0,e=a.length;c<e;c++)b+=a[c].bondOrder;return b};this.getBonds=function(a){for(var b=[],c=0,e=this.bonds.length;c<e;c++)this.bonds[c].contains(a)&&b.push(this.bonds[c]);return b};this.sortAtomsByZ=function(){for(var a=1,b=this.atoms.length;a<b;a++)for(var c=a;0<c&&this.atoms[c].z<this.atoms[c-1].z;){var e=this.atoms[c];this.atoms[c]=this.atoms[c-1];this.atoms[c-1]=e;c--}};this.sortBondsByZ=function(){for(var a=1,b=this.bonds.length;a<
b;a++)for(var c=a;0<c&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;){var e=this.bonds[c];this.bonds[c]=this.bonds[c-1];this.bonds[c-1]=e;c--}};this.setupMetaData=function(){for(var a=0,b=this.atoms.length;a<b;a++){var d=this.atoms[a],e=this.getBonds(d),q=this.getAngles(d);d.isHidden=2==e.length&&f.abs(f.abs(q[1]-q[0])-f.PI)<f.PI/30&&e[0].bondOrder==e[1].bondOrder;q=c.math.angleBetweenLargest(q);d.angleOfLeastInterference=q.angle%(2*f.PI);d.largestAngle=q.largest;
d.coordinationNumber=this.getCoordinationNumber(e);d.bondNumber=e.length}};this.scaleToAverageBondLength=function(a){var b=this.getAverageBondLength();if(0!=b)for(var a=a/b,b=0,c=this.atoms.length;b<c;b++)this.atoms[b].x*=a,this.atoms[b].y*=a};this.getAverageBondLength=function(){if(0==this.bonds.length)return 0;for(var a=0,b=0,c=this.bonds.length;b<c;b++)a+=this.bonds[b].getLength();return a/=this.bonds.length};return!0}})(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);
(function(c,b,a,e){var f=a.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],[0.0060,0,0,0,0.0060,0.02,0,0,0.0010,0.01,0.1,0,0,0,0,1],[]);c.Residue=function(g){this.Ns=9;this.resSeq=g;this.setup=function(a){var b=[a.x-this.cp1.x,a.y-this.cp1.y,a.z-this.cp1.z],f=e.cross(b,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=e.cross(f,b,[]);e.normalize(f);e.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];a=[(a.x+this.cp1.x)/2,(a.y+this.cp1.y)/
2,(a.z+this.cp1.z)/2];this.helix&&(e.scale(f,1.5),e.add(a,f));this.guidePointsSmall[0]=new c.Atom("",a[0]-this.D[0]/2,a[1]-this.D[1]/2,a[2]-this.D[2]/2);for(f=1;f<this.Ns;f++)this.guidePointsSmall[f]=new c.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/this.Ns,this.guidePointsSmall[0].y+this.D[1]*f/this.Ns,this.guidePointsSmall[0].z+this.D[2]*f/this.Ns);e.scale(this.D,4);this.guidePointsLarge[0]=new c.Atom("",a[0]-this.D[0]/2,a[1]-this.D[1]/2,a[2]-this.D[2]/2);for(f=1;f<this.Ns;f++)this.guidePointsLarge[f]=
new c.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/this.Ns,this.guidePointsLarge[0].y+this.D[1]*f/this.Ns,this.guidePointsLarge[0].z+this.D[2]*f/this.Ns)};this.getGuidePointSet=function(a){if(0==a)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1==a)return this.guidePointsSmall;if(2==a)return this.guidePointsLarge};this.computeLineSegments=function(a,b,c,e){this.split=b.helix!=this.helix||b.sheet!=this.sheet;this.lineSegments=this.innerCompute(0,a,b,c,!1);e&&(this.lineSegmentsCartoon=
this.innerCompute(b.helix||b.sheet?2:1,a,b,c,!0))};this.innerCompute=function(g,d,k,q,p){for(var r=[],l=this.getGuidePointSet(g),d=d.getGuidePointSet(g),k=k.getGuidePointSet(g),m=q.getGuidePointSet(g),j=0,t=this.guidePointsLarge.length;j<t;j++){for(var u=a.multiply([d[j].x,d[j].y,d[j].z,1,l[j].x,l[j].y,l[j].z,1,k[j].x,k[j].y,k[j].z,1,m[j].x,m[j].y,m[j].z,1],f,[]),n=[],w=0;10>w;w++){for(g=3;0<g;g--)for(q=0;4>q;q++)u[4*g+q]+=u[4*(g-1)+q];n[w]=new c.Atom("",u[12]/u[15],u[13]/u[15],u[14]/u[15])}r[j]=
n}if(p&&this.arrow)for(g=0;10>g;g++){p=1.5-1.3*g/10;l=b.floor(this.Ns/2);d=r[l];q=0;for(k=r.length;q<k;q++)q!=l&&(m=d[g],j=r[q][g],t=[j.x-m.x,j.y-m.y,j.z-m.z],e.scale(t,p),j.x=m.x+t[0],j.y=m.y+t[1],j.z=m.z+t[2])}return r}}})(ChemDoodle.structures,Math,mat4,vec3);
(function(c,b,a,e,f){b.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.yUnit=this.xUnit=this.title=null;this.continuous=!0;this.integrationSensitivity=0.01;var g=0,h=!1;this.draw=function(a,k,q,p){var r=5,l=0,m=0;a.fillStyle=k.text_color;a.textAlign="center";a.textBaseline="alphabetic";a.font=k.getFontString(k.text_font_size,k.text_font_families);this.xUnit&&(m+=k.text_font_size,a.fillText(this.xUnit,q/2,p-2));this.yUnit&&k.plots_showYAxis&&(l+=k.text_font_size,a.save(),
a.translate(k.text_font_size,p/2),a.rotate(-f.PI/2),a.fillText(this.yUnit,0,0),a.restore());null!=this.title&&(r+=k.text_font_size,a.fillText(this.title,q/2,k.text_font_size));m+=5+k.text_font_size;k.plots_showYAxis&&(l+=5+a.measureText("1000").width);k.plots_showGrid&&(a.strokeStyle=k.plots_gridColor,a.lineWidth=k.plots_gridLineWidth,a.strokeRect(l,r,q-l,p-m-r));a.textAlign="center";a.textBaseline="top";for(var j=this.maxX-this.minX,t=j/100,u=0.0010;u<t||25<j/u;)u*=10;for(var n=0,w=k.plots_flipXAxis?
q:0,j=f.round(this.minX/u)*u;j<=this.maxX;j+=u/2){t=this.getTransformedX(j,k,q,l);if(t>l)if(a.strokeStyle="black",a.lineWidth=1,0==n%2){a.beginPath();a.moveTo(t,p-m);a.lineTo(t,p-m+2);a.stroke();for(var v=j.toFixed(5);"0"==v.charAt(v.length-1);)v=v.substring(0,v.length-1);"."==v.charAt(v.length-1)&&(v=v.substring(0,v.length-1));var x=a.measureText(v).width;k.plots_flipXAxis&&(x*=-1);var A=t-x/2;if(k.plots_flipXAxis?A<w:A>w)a.fillText(v,t,p-m+2),w=t+x/2;k.plots_showGrid&&(a.strokeStyle=k.plots_gridColor,
a.lineWidth=k.plots_gridLineWidth,a.beginPath(),a.moveTo(t,p-m),a.lineTo(t,r),a.stroke())}else a.beginPath(),a.moveTo(t,p-m),a.lineTo(t,p-m+2),a.stroke();n++}if(k.plots_showYAxis||k.plots_showGrid){t=1/k.scale;a.textAlign="right";a.textBaseline="middle";for(j=0;10>=j;j++)if(v=t/10*j,u=r+(p-m-r)*(1-v*k.scale),k.plots_showGrid&&(a.strokeStyle=k.plots_gridColor,a.lineWidth=k.plots_gridLineWidth,a.beginPath(),a.moveTo(l,u),a.lineTo(q,u),a.stroke()),k.plots_showYAxis){a.strokeStyle="black";a.lineWidth=
1;a.beginPath();a.moveTo(l,u);a.lineTo(l-3,u);a.stroke();v*=100;n=f.max(0,3-f.floor(v).toString().length);v=v.toFixed(n);if(0<n)for(;"0"==v.charAt(v.length-1);)v=v.substring(0,v.length-1);"."==v.charAt(v.length-1)&&(v=v.substring(0,v.length-1));a.fillText(v,l-3,u)}}a.strokeStyle="black";a.lineWidth=1;a.beginPath();a.moveTo(q,p-m);a.lineTo(l,p-m);k.plots_showYAxis&&a.lineTo(l,r);a.stroke();if(0<this.dataDisplay.length){a.textAlign="left";a.textBaseline="top";j=t=0;for(v=this.dataDisplay.length;j<v;j++)if(this.dataDisplay[j].value)a.fillText([this.dataDisplay[j].display,
": ",this.dataDisplay[j].value].join(""),l+10,r+10+t*(k.text_font_size+5)),t++;else if(this.dataDisplay[j].tag){u=0;for(n=this.metadata.length;u<n;u++)if(c.stringStartsWith(this.metadata[u],this.dataDisplay[j].tag)){n=this.metadata[u];this.dataDisplay[j].display&&(n=e.inArray("=",this.metadata[u]),n=[this.dataDisplay[j].display,": ",-1<n?this.metadata[u].substring(n+2):this.metadata[u]].join(""));a.fillText(n,l+10,r+10+t*(k.text_font_size+5));t++;break}}}a.strokeStyle=k.plots_color;a.lineWidth=k.plots_width;
n=[];a.beginPath();if(this.continuous){w=!1;j=0;for(v=this.data.length;j<v;j++)if(t=this.getTransformedX(this.data[j].x,k,q,l),t>=l&&t<q)u=this.getTransformedY(this.data[j].y,k,p,m,r),k.plots_showIntegration&&f.abs(this.data[j].y)>this.integrationSensitivity&&n.push(new b.Point(this.data[j].x,this.data[j].y)),w||(a.moveTo(t,u),w=!0),a.lineTo(t,u);else if(w)break}else{j=0;for(v=this.data.length;j<v;j++)t=this.getTransformedX(this.data[j].x,k,q,l),t>=l&&t<q&&(a.moveTo(t,p-m),a.lineTo(t,this.getTransformedY(this.data[j].y,
k,p,m,r)))}a.stroke();if(k.plots_showIntegration&&1<n.length){a.strokeStyle=k.plots_integrationColor;a.lineWidth=k.plots_integrationLineWidth;a.beginPath();j=n[1].x>n[0].x;if(this.flipXAxis&&!j||!this.flipXAxis&&j){for(j=n.length-2;0<=j;j--)n[j].y+=n[j+1].y;w=n[0].y}else{j=1;for(v=n.length;j<v;j++)n[j].y+=n[j-1].y;w=n[n.length-1].y}j=0;for(v=n.length;j<v;j++)t=this.getTransformedX(n[j].x,k,q,l),u=this.getTransformedY(n[j].y/k.scale/w,k,p,m,r),0==j?a.moveTo(t,u):a.lineTo(t,u);a.stroke()}g=l;h=k.plots_flipXAxis};
this.getTransformedY=function(a,b,c,e,f){return f+(c-e-f)*(1-a*b.scale)};this.getTransformedX=function(a,b,c,e){a=e+(a-this.minX)/(this.maxX-this.minX)*(c-e);b.plots_flipXAxis&&(a=c+e-a);return a};this.getInverseTransformedX=function(a,b,c){h&&(a=b+c-a);return(a-c)*(this.maxX-this.minX)/(b-c)+this.minX};this.setup=function(){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=Number.MIN_VALUE,e=0,g=this.data.length;e<g;e++)a=f.min(a,this.data[e].x),b=f.max(b,this.data[e].x),c=f.max(c,this.data[e].y);
this.continuous?(this.minX=a,this.maxX=b):(this.minX=a-1,this.maxX=b+1);e=0;for(g=this.data.length;e<g;e++)this.data[e].y/=c};this.zoom=function(b,c,e,p){b=this.getInverseTransformedX(b,e,g);c=this.getInverseTransformedX(c,e,g);this.minX=f.min(b,c);this.maxX=f.max(b,c);if(p){p=Number.MIN_VALUE;c=0;for(e=this.data.length;c<e;c++)a.isBetween(this.data[c].x,this.minX,this.maxX)&&(p=f.max(p,this.data[c].y));return 1/p}};this.translate=function(a,b){var c=a/(b-g)*(this.maxX-this.minX)*(h?1:-1);this.minX+=
c;this.maxX+=c};this.alertMetadata=function(){alert(this.metadata.join("\n"))};return!0}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(c){c._Mesh=function(){return!0};c._Mesh.prototype.storeData=function(b,a,c){this.positionData=b;this.normalData=a;this.indexData=c};c._Mesh.prototype.setupBuffers=function(b){this.vertexPositionBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.positionData),b.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=b.createBuffer();
b.bindBuffer(b.ARRAY_BUFFER,this.vertexNormalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.normalData),b.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),b.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);
if(this.partitions)for(var a=0,c=this.partitions.length;a<c;a++){var f=this.partitions[a],g=this.generateBuffers(b,f.positionData,f.normalData,f.indexData);f.vertexPositionBuffer=g[0];f.vertexNormalBuffer=g[1];f.vertexIndexBuffer=g[2]}};c._Mesh.prototype.generateBuffers=function(b,a,c,f){var g=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);g.itemSize=3;g.numItems=a.length/3;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,
new Float32Array(c),b.STATIC_DRAW);a.itemSize=3;a.numItems=c.length/3;c=null;f&&(c=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(f),b.STATIC_DRAW),c.itemSize=1,c.numItems=f.length);return[g,a,c]};c._Mesh.prototype.bindBuffers=function(b){this.vertexPositionBuffer||this.setupBuffers(b);b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,b.FLOAT,
!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,b.FLOAT,!1,0,0);this.vertexIndexBuffer&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures,Math);
(function(c,b){c.Cylinder=function(a,c,f){for(var g=[],h=[],d=0;d<f;d++){var k=2*d*b.PI/f,q=b.cos(k),k=b.sin(k);h.push(q,0,k);g.push(a*q,0,a*k);h.push(q,0,k);g.push(a*q,c,a*k)}h.push(1,0,0);g.push(a,0,0);h.push(1,0,0);g.push(a,c,0);this.storeData(g,h);return!0};c.Cylinder.prototype=new c._Mesh})(ChemDoodle.structures,Math);
(function(c,b){c.Sphere=function(a,c,f){for(var g=[],h=[],d=0;d<=c;d++)for(var k=d*b.PI/c,q=b.sin(k),p=b.cos(k),k=0;k<=f;k++){var r=2*k*b.PI/f,l=b.sin(r),r=b.cos(r)*q,m=p,l=l*q;h.push(r,m,l);g.push(a*r,a*m,a*l)}a=[];f+=1;for(d=0;d<c;d++)for(k=0;k<f;k++)q=d*f+k%f,p=q+f,a.push(q),a.push(p),a.push(q+1),k<f-1&&(a.push(p),a.push(p+1),a.push(q+1));this.storeData(g,h,a);return!0};c.Sphere.prototype=new c._Mesh})(ChemDoodle.structures,Math);
(function(c,b,a,e){function f(a,b,e,f){this.name=b;this.entire=a;this.pi=f;this.getColor=function(b){return b.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(c[this.name]?this.name:"*",b):this.helix?a.front?b.proteins_ribbonCartoonHelixPrimaryColor:b.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?b.proteins_ribbonCartoonSheetColor:a.front?b.proteins_primaryColor:b.proteins_secondaryColor};this.getResidueColor=function(a,b){var e=c[a];return b.proteins_useShapelyColors?e.shapelyColor:
b.proteins_useAminoColors?e.aminoColor:b.proteins_usePolarityColors&&e.polar?"#C10000":"#FFFFFF"};this.render=function(a,b){null!=this.entire.partitions&&this.pi!=this.entire.partitions.lastRender&&(g(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi);this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=
1,this.vertexIndexBuffer.numItems=e.length);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a.material.setDiffuseColor(this.getColor(b));a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}var g=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer);a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer);a.vertexAttribPointer(a.shader.vertexNormalAttribute,
b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)};b.Ribbon=function(b,c,k){var q=b[0].lineSegments.length,p=b[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;var r=null;this.front=0<c;for(var l=0,m=b.length-1;l<m;l++){if(null==r||65E3<r.positionData.length)0<this.partitions.length&&l--,r={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(r);var j=b[l];r.count++;for(var t=0;t<q;t++)for(var u=k?j.lineSegmentsCartoon[t]:
j.lineSegments[t],n=0==t,w=!1,v=0;v<p;v++){var x=u[v],A=l,D=v+1;l==b.length-2&&v==p-1?D--:v==p-1&&(A++,D=0);var D=k?b[A].lineSegmentsCartoon[t][D]:b[A].lineSegments[t][D],A=!1,C=t+1;t==q-1&&(C-=2,A=!0);var C=k?j.lineSegmentsCartoon[C][v]:j.lineSegments[C][v],D=[D.x-x.x,D.y-x.y,D.z-x.z],C=[C.x-x.x,C.y-x.y,C.z-x.z],B=e.cross(D,C,[]);0==v&&(e.normalize(D),e.scale(D,-1),r.normalData.push(D[0],D[1],D[2]),r.positionData.push(x.x,x.y,x.z));n||w?(e.normalize(C),e.scale(C,-1),r.normalData.push(C[0],C[1],C[2]),
r.positionData.push(x.x,x.y,x.z),n&&v==p-1&&(n=!1,v=-1)):(e.normalize(B),(A&&!this.front||!A&&this.front)&&e.scale(B,-1),r.normalData.push(B[0],B[1],B[2]),e.scale(B,a.abs(c)),r.positionData.push(x.x+B[0],x.y+B[1],x.z+B[2]),t==q-1&&v==p-1&&(w=!0,v=-1));if(-1==v||v==p-1)e.normalize(D),r.normalData.push(D[0],D[1],D[2]),r.positionData.push(x.x,x.y,x.z)}}q+=2;p+=2;k&&(this.cartoonSegments=[]);this.segments=[];c=0;for(j=this.partitions.length;c<j;c++){r=this.partitions[c];n=null;k&&(n=[]);l=0;for(m=r.count-
1;l<m;l++){u=l;for(t=0;t<c;t++)u+=this.partitions[t].count-1;t=b[u];0<l&&k&&t.split&&(v=new f(this,null,n,c),t.helix&&(v.helix=!0),t.sheet&&(v.sheet=!0),this.cartoonSegments.push(v),n=[]);w=l*q*p;x=[];t=0;for(A=q-1;t<A;t++){D=w+t*p;for(v=0;v<p;v++){C=1;l==r.count-1?C=0:v==p-1&&(C=q*p-v);C=[D+v,D+p+v,D+p+v+C,D+v,D+v+C,D+p+v+C];if(v!=p-1)for(B=0;6>B;B++)x.push(C[B]);v==p-2&&l<r.count-2&&(B=q*p-v,C[2]+=B,C[4]+=B,C[5]+=B);for(B=0;6>B;B++)r.indexData.push(C[B]);if(k)for(B=0;6>B;B++)n.push(C[B])}}this.segments.push(new f(this,
b[u+1].name,x,c))}if(k){v=new f(this,null,n,c);u=r.count-1;for(t=0;t<c;t++)u+=this.partitions[t].count-1;t=b[u];t.helix&&(v.helix=!0);t.sheet&&(v.sheet=!0);this.cartoonSegments.push(v)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);1==this.partitions.length&&(this.partitions=null);this.render=function(a,b){this.bindBuffers(a);var c=b.macro_colorByChain?this.chainColor:null;c||(c=this.front?b.proteins_primaryColor:b.proteins_secondaryColor);
a.material.setDiffuseColor(c);a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0);if(this.partitions)for(var c=1,e=this.partitions.length;c<e;c++){var f=this.partitions[c];g(a,f);a.drawElements(a.TRIANGLES,f.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}};return!0};b.Ribbon.prototype=new b._Mesh})(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3);
(function(c,b,a){b.Light=function(b,f,g){this.diffuseRGB=c.getRGB(b,1);this.specularRGB=c.getRGB(f,1);this.direction=g;this.lightScene=function(b){b.uniform3f(b.getUniformLocation(b.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);b.uniform3f(b.getUniformLocation(b.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var c=a.create(this.direction);a.normalize(c);a.negate(c);b.uniform3f(b.getUniformLocation(b.program,
"u_light.direction"),c[0],c[1],c[2]);var e=[0,0,0],c=[e[0]+c[0],e[1]+c[1],e[2]+c[2]],e=a.length(c);0==e?c=[0,0,1]:a.scale(1/e);b.uniform3f(b.getUniformLocation(b.program,"u_light.half_vector"),c[0],c[1],c[2])};return!0}})(ChemDoodle.math,ChemDoodle.structures,vec3);(function(c){c.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0]);return!0};c.Line.prototype=new c._Mesh})(ChemDoodle.structures);
(function(c,b){b.Material=function(a){var b=a.getUniformLocation(a.program,"u_material.ambient_color"),f=a.getUniformLocation(a.program,"u_material.diffuse_color"),g=a.getUniformLocation(a.program,"u_material.specular_color"),h=a.getUniformLocation(a.program,"u_material.shininess"),d=a.getUniformLocation(a.program,"u_material.alpha");this.setTempColors=function(k,q,p,r){if(!this.aCache||this.aCache!=k)this.aCache=k,k=c.getRGB(k,1),a.uniform3f(b,k[0],k[1],k[2]);if(null!=q&&(!this.dCache||this.dCache!=
q))this.dCache=q,k=c.getRGB(q,1),a.uniform3f(f,k[0],k[1],k[2]);if(!this.sCache||this.sCache!=p)this.sCache=p,k=c.getRGB(p,1),a.uniform3f(g,k[0],k[1],k[2]);if(!this.snCache||this.snCache!=r)this.snCache=r,a.uniform1f(h,r);this.alCache=1;a.uniform1f(d,1)};this.setDiffuseColor=function(b){if(!this.dCache||this.dCache!=b)this.dCache=b,b=c.getRGB(b,1),a.uniform3f(f,b[0],b[1],b[2])};this.setAlpha=function(b){if(!this.alCache||this.alCache!=b)this.alCache=b,a.uniform1f(d,b)};return!0}})(ChemDoodle.math,
ChemDoodle.structures);
(function(c,b,a){c.MolecularSurface=function(e,f,g,h,d){function k(a,b,c,e){var f=a.index;if(a.contained)for(var f=-1,d=Infinity,g=0,k=b.length;g<k;g++)for(var j=b[g],p=0,h=j.length;p<h;p++){var l=j[p];if(!l.contained&&l.index!=c&&l.index!=e){var q=l.distance3D(a);q<d&&(f=l.index,d=q)}}return f}for(var q=[],p=[],r=[],l=[],m=0;m<=f;m++)for(var j=m*a.PI/f,t=a.sin(j),u=a.cos(j),j=0;j<=g;j++){var n=2*j*a.PI/g;l.push(a.cos(n)*t,u,a.sin(n)*t)}t=[];m=0;for(j=e.atoms.length;m<j;m++){for(var u=[],w=e.atoms[m],
v=b[w.label][d]+h,x=[],n=0,A=e.atoms.length;n<A;n++)if(n!=m){var D=e.atoms[n];D.index=n;w.distance3D(D)<v+b[D.label][d]+h&&x.push(D)}n=0;for(A=l.length;n<A;n+=3){for(var C=new c.Atom("C",w.x+v*l[n],w.y+v*l[n+1],w.z+v*l[n+2]),B=0,G=x.length;B<G;B++)if(D=x[B],C.distance3D(D)<b[D.label][d]+h){C.contained=!0;break}u.push(C)}t.push(u)}e=[];g++;for(m=0;m<f;m++)for(j=0;j<g;j++)d=m*g+j%g,h=d+g,e.push(d),e.push(h),e.push(d+1),j<g-1&&(e.push(h),e.push(h+1),e.push(d+1));m=B=0;for(j=t.length;m<j;m++){u=t[m];
n=0;for(A=u.length;n<A;n++)C=u[n],C.contained||(C.index=B,B++,q.push(C.x,C.y,C.z),p.push(l[3*n],l[3*n+1],l[3*n+2]));n=0;for(A=e.length;n<A;n+=3)d=u[e[n]],h=u[e[n+1]],C=u[e[n+2]],!d.contained&&!h.contained&&!C.contained&&r.push(d.index,h.index,C.index)}l=[];m=0;for(j=t.length;m<j;m++){u=t[m];n=0;for(A=e.length;n<A;n+=3){d=u[e[n]];h=u[e[n+1]];C=u[e[n+2]];x=[];B=0;for(G=t.length;B<G;B++)B!=m&&x.push(t[B]);if((!d.contained||!h.contained||!C.contained)&&(d.contained||h.contained||C.contained))if(f=k(d,
x,-1,-1),g=k(h,x,f,-1),x=k(C,x,f,g),-1!=f&&-1!=g&&-1!=x){h=!1;B=0;for(G=l.length;B<G;B+=3)if(d=l[B],C=l[B+1],w=l[B+2],v=g==d||g==C||g==w,D=x==d||x==C||x==w,(f==d||f==C||f==w)&&v&&D){h=!0;break}h||l.push(f,g,x)}}}r=r.concat(l);this.storeData(q,p,r);return!0};c.MolecularSurface.prototype=new c._Mesh})(ChemDoodle.structures,ChemDoodle.ELEMENT,Math);
(function(c,b){c.Shader=function(){this.init=function(a){var b=this.getShader(a,"vertex-shader");null==b&&(b=this.loadDefaultVertexShader(a));var c=this.getShader(a,"fragment-shader");null==c&&(c=this.loadDefaultFragmentShader(a));a.attachShader(a.program,b);a.attachShader(a.program,c);a.linkProgram(a.program);a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(program));a.useProgram(a.program);this.vertexPositionAttribute=a.getAttribLocation(a.program,
"a_vertex_position");a.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal");a.enableVertexAttribArray(this.vertexNormalAttribute)};this.getShader=function(a,c){var f=b.getElementById(c);if(!f)return null;for(var g=[],h=f.firstChild;h;)3==h.nodeType&&g.push(h.textContent),h=h.nextSibling;if("x-shader/x-fragment"==f.type)h=a.createShader(a.FRAGMENT_SHADER);else if("x-shader/x-vertex"==f.type)h=a.createShader(a.VERTEX_SHADER);
else return null;a.shaderSource(h,g.join(""));a.compileShader(h);return!a.getShaderParameter(h,a.COMPILE_STATUS)?(alert(f.type+" "+a.getShaderInfoLog(h)),null):h};this.loadDefaultVertexShader=function(a){var b=[];b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");
b.push("float shininess;");b.push("float alpha;");b.push("};");b.push("attribute vec3 a_vertex_position;");b.push("attribute vec3 a_vertex_normal;");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("uniform mat4 u_model_view_matrix;");b.push("uniform mat4 u_projection_matrix;");b.push("uniform mat3 u_normal_matrix;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");
b.push("{");b.push("if(length(a_vertex_normal)==0.0){");b.push("v_normal = a_vertex_normal;");b.push("}else{");b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);");b.push("}");b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);");b.push("v_light_direction = u_light.direction;");b.push("v_ambient = vec4(u_material.ambient_color, 1.0);");b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;");b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);");
b.push("}");var c=a.createShader(a.VERTEX_SHADER);a.shaderSource(c,b.join(""));a.compileShader(c);return!a.getShaderParameter(c,a.COMPILE_STATUS)?(alert("Vertex shader failed to compile: "+a.getShaderInfoLog(c)),null):c};this.loadDefaultFragmentShader=function(a){var b=[];b.push("precision mediump float;\n");b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");
b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("float shininess;");b.push("float alpha;");b.push("};");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");b.push("if(length(v_normal)==0.0){");b.push("gl_FragColor = vec4(v_diffuse.rgba);");b.push("}else{");
b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);");b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);");b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);");b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);");b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);");b.push("gl_FragColor = color+v_ambient;");b.push("gl_FragColor.a*=u_material.alpha;");b.push("}");b.push("}");var c=a.createShader(a.FRAGMENT_SHADER);
a.shaderSource(c,b.join(""));a.compileShader(c);return!a.getShaderParameter(c,a.COMPILE_STATUS)?(alert("Fragment shader failed to compile: "+a.getShaderInfoLog(c)),null):c};return!0}})(ChemDoodle.structures,document);
(function(c,b){c.Shape=function(a,e){for(var f=a.length,g=[],h=[],d=new c.Point,k=0,q=f;k<q;k++){var p=k+1;k==q-1&&(p=0);for(var r=a[k],p=a[p],l=b.cross([0,0,1],[p.x-r.x,p.y-r.y,0]),m=0;2>m;m++)g.push(r.x,r.y,e/2),g.push(r.x,r.y,-e/2),g.push(p.x,p.y,e/2),g.push(p.x,p.y,-e/2);for(m=0;4>m;m++)h.push(l[0],l[1],l[2]);h.push(0,0,1);h.push(0,0,-1);h.push(0,0,1);h.push(0,0,-1);d.add(r)}d.x/=f;d.y/=f;h.push(0,0,1);g.push(d.x,d.y,e/2);h.push(0,0,-1);g.push(d.x,d.y,-e/2);d=[];r=8*f;k=0;for(q=f;k<q;k++)f=8*
k,d.push(f),d.push(f+1),d.push(f+3),d.push(f),d.push(f+2),d.push(f+3),d.push(f+4),d.push(f+6),d.push(r),d.push(f+5),d.push(f+7),d.push(r+1);this.storeData(g,h,d);return!0};c.Shape.prototype=new c._Mesh})(ChemDoodle.structures,vec3);
(function(c,b,a){c.Star=function(){for(var b=[0.8944,0.4472,0,0.2764,0.4472,0.8506,0.2764,0.4472,-0.8506,-0.7236,0.4472,0.5257,-0.7236,0.4472,-0.5257,-0.3416,0.4472,0,-0.1056,0.4472,0.3249,-0.1056,0.4472,-0.3249,0.2764,0.4472,0.2008,0.2764,0.4472,-0.2008,-0.8944,-0.4472,0,-0.2764,-0.4472,0.8506,-0.2764,-0.4472,-0.8506,0.7236,-0.4472,0.5257,0.7236,-0.4472,-0.5257,0.3416,-0.4472,0,0.1056,-0.4472,0.3249,0.1056,-0.4472,-0.3249,-0.2764,-0.4472,0.2008,-0.2764,-0.4472,-0.2008,-0.5527,0.1058,0,-0.1708,0.1058,
0.5527,-0.1708,0.1058,-0.5527,0.4471,0.1058,0.3249,0.4471,0.1058,-0.3249,0.5527,-0.1058,0,0.1708,-0.1058,0.5527,0.1708,-0.1058,-0.5527,-0.4471,-0.1058,0.3249,-0.4471,-0.1058,-0.3249,0,1,0,0,-1,0],c=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,
10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],g=[],h=[],d=[],k=0,q=c.length;k<q;k+=3){var p=3*c[k],r=3*c[k+1],l=3*c[k+2],p=[b[p],b[p+1],b[p+2]],r=[b[r],b[r+1],b[r+2]],l=[b[l],b[l+1],b[l+2]],m=a.cross([l[0]-r[0],l[1]-r[1],l[2]-r[2]],[p[0]-r[0],p[1]-r[1],p[2]-r[2]],[]);a.normalize(m);g.push(p[0],p[1],p[2],r[0],r[1],r[2],l[0],l[1],l[2]);h.push(m[0],m[1],m[2],m[0],m[1],
m[2],m[0],m[1],m[2]);d.push(k,k+1,k+2)}this.storeData(g,h,d);return!0};c.Star.prototype=new c._Mesh})(ChemDoodle.structures,Math,vec3);
(function(c,b,a,e,f,g){var h=function(a,b,c){var g=e.sqrt(b[1]*b[1]+b[2]*b[2]),h=[1,0,0,0,0,b[2]/g,-b[1]/g,0,0,b[1]/g,b[2]/g,0,0,0,0,1],l=[1,0,0,0,0,b[2]/g,b[1]/g,0,0,-b[1]/g,b[2]/g,0,0,0,0,1],m=[g,0,-b[0],0,0,1,0,0,b[0],0,g,0,0,0,0,1],b=[g,0,b[0],0,0,1,0,0,-b[0],0,g,0,0,0,0,1],c=[e.cos(c),-e.sin(c),0,0,e.sin(c),e.cos(c),0,0,0,0,1,0,0,0,0,1],j=f.multiply(h,f.multiply(m,f.multiply(c,f.multiply(b,l,[]))));this.rotate=function(){return f.multiplyVec3(j,a)}};a.Tube=function(d,k,q){var p=d[0].lineSegments[0].length,
r=[],l=[];this.ends=[];this.ends.push(d[0].lineSegments[0][0]);this.ends.push(d[d.length-2].lineSegments[0][0]);for(var m=[1,0,0],j=0,t=d.length-1;j<t;j++)for(var u=d[j],n=Infinity,w=new a.Atom("",d[j+1].cp1.x,d[j+1].cp1.y,d[j+1].cp1.z),v=0;v<p;v++){var x=u.lineSegments[0][v],A=null,A=v==p-1?j==d.length-2?u.lineSegments[0][v-1]:d[j+1].lineSegments[0][0]:u.lineSegments[0][v+1],A=[A.x-x.x,A.y-x.y,A.z-x.z];g.normalize(A);j==d.length-2&&v==p-1&&g.scale(A,-1);var D=vec3.cross(A,m,[]);g.normalize(D);g.scale(D,
k/2);for(var D=new h(D,A,2*Math.PI/q),A=0,C=q;A<C;A++){var B=D.rotate();A==e.floor(q/4)&&(m=[B[0],B[1],B[2]]);l.push(B[0],B[1],B[2]);r.push(x.x+B[0],x.y+B[1],x.z+B[2])}null!=w&&(A=x.distance3D(w),A<n&&(n=A,d[j+1].pPoint=x))}m=[];j=0;for(t=d.length-2;j<t;j++){u=j*p*q;v=0;for(n=p;v<n;v++){w=u+v*q;for(A=0;A<q;A++)A==q-1&&(nextRes=j==d.length-2?0:-A),x=w+A,m.push(x),m.push(x+q),m.push(x+q+1),m.push(x),m.push(x+1),m.push(x+q+1)}}this.storeData(r,l,m);q=[new a.Point(2,0)];for(j=0;60>j;j++)p=j/60*e.PI,q.push(new a.Point(2*
e.cos(p),-2*e.sin(p)));q.push(new a.Point(-2,0),new a.Point(-2,4),new a.Point(2,4));var G=new a.Shape(q,1);this.render=function(j,p){this.bindBuffers(j);j.material.setDiffuseColor(p.macro_colorByChain?this.chainColor:p.nucleics_tubeColor);j.drawElements(j.TRIANGLES,this.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0);j.sphereBuffer.bindBuffers(j);for(var h=0;2>h;h++){var l=this.ends[h],l=f.translate(j.modelViewMatrix,[l.x,l.y,l.z],[]),q=k/2;f.scale(l,[q,q,q]);j.setMatrixUniforms(l);j.drawElements(j.TRIANGLES,
j.sphereBuffer.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0)}j.cylinderBuffer.bindBuffers(j);h=1;for(q=d.length-1;h<q;h++){var r=d[h],n=r.pPoint,m=new a.Atom("",r.cp2.x,r.cp2.y,r.cp2.z),l=1.001*n.distance3D(m),r=[k/4,l,k/4],l=f.translate(j.modelViewMatrix,[n.x,n.y,n.z],[]),u=[0,1,0],t=0,v=null,w=[m.x-n.x,m.y-n.y,m.z-n.z];n.x==m.x&&n.z==m.z?(v=[0,0,1],n.y<n.y&&(t=e.PI)):(t=c.vec3AngleFrom(u,w),v=g.cross(u,w,[]));0!=t&&f.rotate(l,t,v);f.scale(l,r);j.setMatrixUniforms(l);j.drawArrays(j.TRIANGLE_STRIP,
0,j.cylinderBuffer.vertexPositionBuffer.numItems)}G.bindBuffers(j);!p.nucleics_useShapelyColors&&!p.macro_colorByChain&&j.material.setDiffuseColor(p.nucleics_baseColor);h=1;for(q=d.length-1;h<q;h++)r=d[h],m=r.cp2,l=f.translate(j.modelViewMatrix,[m.x,m.y,m.z],[]),u=[0,1,0],t=0,n=r.cp3,w=[n.x-m.x,n.y-m.y,n.z-m.z],m.x==n.x&&m.z==n.z?(v=[0,0,1],m.y<m.y&&(t=e.PI)):(t=c.vec3AngleFrom(u,w),v=g.cross(u,w,[])),0!=t&&f.rotate(l,t,v),m=[1,0,0],t=f.rotate(f.identity([]),t,v),f.multiplyVec3(t,m),t=r.cp4,n=r.cp5,
t.y==n.y&&t.z==n.z||(t=[n.x-t.x,n.y-t.y,n.z-t.z],n=c.vec3AngleFrom(m,t),0>g.dot(w,g.cross(m,t))&&(n*=-1),f.rotateY(l,n)),p.nucleics_useShapelyColors&&!p.macro_colorByChain&&(b[r.name]?j.material.setDiffuseColor(b[r.name].shapelyColor):j.material.setDiffuseColor(b["*"].shapelyColor)),j.setMatrixUniforms(l),j.drawElements(j.TRIANGLES,G.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0)};return!0};a.Tube.prototype=new a._Mesh})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,Math,mat4,vec3);
(function(c){c.UnitCell=function(b){var a=[],c=[],f=function(b,f,g,q){a.push(b[0],b[1],b[2]);a.push(f[0],f[1],f[2]);a.push(g[0],g[1],g[2]);a.push(q[0],q[1],q[2]);for(b=0;4>b;b++)c.push(0,0,0)};f(b.o,b.x,b.xy,b.y);f(b.o,b.y,b.yz,b.z);f(b.o,b.z,b.xz,b.x);f(b.yz,b.y,b.xy,b.xyz);f(b.xyz,b.xz,b.z,b.yz);f(b.xy,b.x,b.xz,b.xyz);b=[];for(f=0;6>f;f++){var g=4*f;b.push(g,g+1,g+1,g+2,g+2,g+3,g+3,g)}this.storeData(a,c,b);return!0};c.UnitCell.prototype=new c._Mesh})(ChemDoodle.structures,vec3);
(function(c,b,a){c.Plate=function(c){this.lanes=Array(c);i=0;for(ii=c;i<ii;i++)this.lanes[i]=[];this.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(a,b){return a-b})};this.draw=function(c){var e=c.canvas.width,h=c.canvas.height;this.origin=9*h/10;this.front=h/10;this.laneLength=this.origin-this.front;c.strokeStyle="#000000";c.beginPath();c.moveTo(0,this.front);b.contextHashTo(c,0,this.front,e,this.front,3,3);c.closePath();c.stroke();c.beginPath();c.moveTo(0,this.origin);
c.lineTo(e,this.origin);c.closePath();c.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){h=(i+1)*e/(ii+1);c.beginPath();c.moveTo(h,this.origin);c.lineTo(h,this.origin+3);c.closePath();c.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var d=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":c.beginPath();c.arc(h,d,3,0,2*a.PI,!1);c.closePath();break;case "expanded":c.beginPath();c.arc(h,d,7,0,2*a.PI,!1);c.closePath();break;case "widened":b.contextOval(c,h-
18,d-10,36,10);break;case "cresent":c.beginPath(),c.arc(h,d,9,0,a.PI,!0),c.closePath()}switch(this.lanes[i][s].style){case "solid":c.fillStyle="#000000";c.fill();break;case "transparent":c.stroke()}}}};return!0};c.Plate.Spot=function(a,b,c){this.type=a;this.rf=b;this.style=c?c:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(c,b,a){c.default_backgroundColor="#FFFFFF";c.default_scale=1;c.default_rotateAngle=0;c.default_bondLength_2D=20;c.default_angstromsPerBondLength=1.25;c.default_lightDirection_3D=[-0.1,-0.1,-1];c.default_lightDiffuseColor_3D="#FFFFFF";c.default_lightSpecularColor_3D="#FFFFFF";c.default_projectionPerspective_3D=!0;c.default_projectionPerspectiveVerticalFieldOfView_3D=45;c.default_projectionOrthoWidth_3D=40;c.default_projectionWidthHeightRatio_3D=null;c.default_projectionFrontCulling_3D=0.1;
c.default_projectionBackCulling_3D=1E4;c.default_atoms_display=!0;c.default_atoms_color="#000000";c.default_atoms_font_size_2D=12;c.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];c.default_atoms_font_bold_2D=!1;c.default_atoms_font_italic_2D=!1;c.default_atoms_circles_2D=!1;c.default_atoms_circleDiameter_2D=10;c.default_atoms_circleBorderWidth_2D=1;c.default_atoms_lonePairDistance_2D=8;c.default_atoms_lonePairSpread_2D=4;c.default_atoms_lonePairDiameter_2D=1;c.default_atoms_useJMOLColors=
!1;c.default_atoms_usePYMOLColors=!1;c.default_atoms_resolution_3D=60;c.default_atoms_sphereDiameter_3D=0.8;c.default_atoms_useVDWDiameters_3D=!1;c.default_atoms_vdwMultiplier_3D=1;c.default_atoms_materialAmbientColor_3D="#000000";c.default_atoms_materialSpecularColor_3D="#555555";c.default_atoms_materialShininess_3D=32;c.default_atoms_implicitHydrogens_2D=!0;c.default_atoms_displayTerminalCarbonLabels_2D=!1;c.default_atoms_showHiddenCarbons_2D=!0;c.default_atoms_displayAllCarbonLabels_2D=!1;c.default_atoms_nonBondedAsStars_3D=
!1;c.default_bonds_display=!0;c.default_bonds_color="#000000";c.default_bonds_width_2D=1;c.default_bonds_saturationWidth_2D=0.2;c.default_bonds_ends_2D="round";c.default_bonds_useJMOLColors=!1;c.default_bonds_usePYMOLColors=!1;c.default_bonds_colorGradient=!1;c.default_bonds_saturationAngle_2D=a.PI/3;c.default_bonds_symmetrical_2D=!1;c.default_bonds_clearOverlaps_2D=!1;c.default_bonds_overlapClearWidth_2D=0.5;c.default_bonds_atomLabelBuffer_2D=0.25;c.default_bonds_wedgeThickness_2D=0.22;c.default_bonds_hashWidth_2D=
1;c.default_bonds_hashSpacing_2D=2.5;c.default_bonds_showBondOrders_3D=!1;c.default_bonds_resolution_3D=60;c.default_bonds_renderAsLines_3D=!1;c.default_bonds_cylinderDiameter_3D=0.3;c.default_bonds_materialAmbientColor_3D="#222222";c.default_bonds_materialSpecularColor_3D="#555555";c.default_bonds_materialShininess_3D=32;c.default_proteins_displayRibbon=!0;c.default_proteins_displayBackbone=!1;c.default_proteins_backboneThickness=1.5;c.default_proteins_backboneColor="#CCCCCC";c.default_proteins_ribbonCartoonize=
!1;c.default_proteins_useShapelyColors=!1;c.default_proteins_useAminoColors=!1;c.default_proteins_usePolarityColors=!1;c.default_proteins_primaryColor="#FF0D0D";c.default_proteins_secondaryColor="#FFFF30";c.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740";c.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF";c.default_proteins_ribbonCartoonSheetColor="#E8BB99";c.default_proteins_ribbonThickness=0.2;c.default_proteins_materialAmbientColor_3D="#222222";c.default_proteins_materialSpecularColor_3D=
"#555555";c.default_proteins_materialShininess_3D=32;c.default_nucleics_display=!0;c.default_nucleics_tubeColor="#CCCCCC";c.default_nucleics_baseColor="#C10000";c.default_nucleics_useShapelyColors=!0;c.default_nucleics_tubeThickness=1.5;c.default_nucleics_tubeResolution_3D=60;c.default_nucleics_materialAmbientColor_3D="#222222";c.default_nucleics_materialSpecularColor_3D="#555555";c.default_nucleics_materialShininess_3D=32;c.default_macro_displayAtoms=!1;c.default_macro_displayBonds=!1;c.default_macro_atomToLigandDistance=
-1;c.default_macro_showWater=!1;c.default_macro_colorByChain=!1;c.default_surfaces_display=!0;c.default_surfaces_style="Dot";c.default_surfaces_color="#E9B862";c.default_surfaces_materialAmbientColor_3D="#000000";c.default_surfaces_materialSpecularColor_3D="#000000";c.default_surfaces_materialShininess_3D=32;c.default_crystals_displayUnitCell=!0;c.default_crystals_unitCellColor="green";c.default_crystals_unitCellLineWidth=1;c.default_plots_color="#000000";c.default_plots_width=1;c.default_plots_showIntegration=
!1;c.default_plots_integrationColor="#c10000";c.default_plots_integrationLineWidth=1;c.default_plots_showGrid=!1;c.default_plots_gridColor="gray";c.default_plots_gridLineWidth=0.5;c.default_plots_showYAxis=!0;c.default_plots_flipXAxis=!1;c.default_text_font_size=12;c.default_text_font_families=["Helvetica","Arial","Dialog"];c.default_text_color="#000000";b.VisualSpecifications=function(){this.backgroundColor=c.default_backgroundColor;this.scale=c.default_scale;this.rotateAngle=c.default_rotateAngle;
this.bondLength=c.default_bondLength_2D;this.angstromsPerBondLength=c.default_angstromsPerBondLength;this.lightDirection_3D=c.default_lightDirection_3D;this.lightDiffuseColor_3D=c.default_lightDiffuseColor_3D;this.lightSpecularColor_3D=c.default_lightSpecularColor_3D;this.projectionPerspective_3D=c.default_projectionPerspective_3D;this.projectionPerspectiveVerticalFieldOfView_3D=c.default_projectionPerspectiveVerticalFieldOfView_3D;this.projectionOrthoWidth_3D=c.default_projectionOrthoWidth_3D;this.projectionWidthHeightRatio_3D=
c.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=c.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=c.default_projectionBackCulling_3D;this.atoms_display=c.default_atoms_display;this.atoms_color=c.default_atoms_color;this.atoms_font_size_2D=c.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var a=0,b=c.default_atoms_font_families_2D.length;a<b;a++)this.atoms_font_families_2D[a]=c.default_atoms_font_families_2D[a];this.atoms_font_bold_2D=c.default_atoms_font_bold_2D;
this.atoms_font_italic_2D=c.default_atoms_font_italic_2D;this.atoms_circles_2D=c.default_atoms_circles_2D;this.atoms_circleDiameter_2D=c.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=c.default_atoms_circleBorderWidth_2D;this.atoms_lonePairDistance_2D=c.default_atoms_lonePairDistance_2D;this.atoms_lonePairSpread_2D=c.default_atoms_lonePairSpread_2D;this.atoms_lonePairDiameter_2D=c.default_atoms_lonePairDiameter_2D;this.atoms_useJMOLColors=c.default_atoms_useJMOLColors;this.atoms_usePYMOLColors=
c.default_atoms_usePYMOLColors;this.atoms_resolution_3D=c.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=c.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=c.default_atoms_useVDWDiameters_3D;this.atoms_vdwMultiplier_3D=c.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=c.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=c.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=
c.default_atoms_implicitHydrogens_2D;this.atoms_displayTerminalCarbonLabels_2D=c.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=c.default_atoms_showHiddenCarbons_2D;this.atoms_displayAllCarbonLabels_2D=c.default_atoms_displayAllCarbonLabels_2D;this.atoms_nonBondedAsStars_3D=c.default_atoms_nonBondedAsStars_3D;this.bonds_display=c.default_bonds_display;this.bonds_color=c.default_bonds_color;this.bonds_width_2D=c.default_bonds_width_2D;this.bonds_saturationWidth_2D=c.default_bonds_saturationWidth_2D;
this.bonds_ends_2D=c.default_bonds_ends_2D;this.bonds_useJMOLColors=c.default_bonds_useJMOLColors;this.bonds_usePYMOLColors=c.default_bonds_usePYMOLColors;this.bonds_colorGradient=c.default_bonds_colorGradient;this.bonds_saturationAngle_2D=c.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=c.default_bonds_symmetrical_2D;this.bonds_clearOverlaps_2D=c.default_bonds_clearOverlaps_2D;this.bonds_overlapClearWidth_2D=c.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=c.default_bonds_atomLabelBuffer_2D;
this.bonds_wedgeThickness_2D=c.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=c.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=c.default_bonds_hashSpacing_2D;this.bonds_showBondOrders_3D=c.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=c.default_bonds_resolution_3D;this.bonds_renderAsLines_3D=c.default_bonds_renderAsLines_3D;this.bonds_cylinderDiameter_3D=c.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=c.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=
c.default_bonds_materialSpecularColor_3D;this.bonds_materialShininess_3D=c.default_bonds_materialShininess_3D;this.proteins_displayRibbon=c.default_proteins_displayRibbon;this.proteins_displayBackbone=c.default_proteins_displayBackbone;this.proteins_backboneThickness=c.default_proteins_backboneThickness;this.proteins_backboneColor=c.default_proteins_backboneColor;this.proteins_ribbonCartoonize=c.default_proteins_ribbonCartoonize;this.proteins_useShapelyColors=c.default_proteins_useShapelyColors;this.proteins_useAminoColors=
c.default_proteins_useAminoColors;this.proteins_usePolarityColors=c.default_proteins_usePolarityColors;this.proteins_primaryColor=c.default_proteins_primaryColor;this.proteins_secondaryColor=c.default_proteins_secondaryColor;this.proteins_ribbonCartoonHelixPrimaryColor=c.default_proteins_ribbonCartoonHelixPrimaryColor;this.proteins_ribbonCartoonHelixSecondaryColor=c.default_proteins_ribbonCartoonHelixSecondaryColor;this.proteins_ribbonCartoonSheetColor=c.default_proteins_ribbonCartoonSheetColor;this.proteins_ribbonThickness=
c.default_proteins_ribbonThickness;this.proteins_materialAmbientColor_3D=c.default_proteins_materialAmbientColor_3D;this.proteins_materialSpecularColor_3D=c.default_proteins_materialSpecularColor_3D;this.proteins_materialShininess_3D=c.default_proteins_materialShininess_3D;this.macro_displayAtoms=c.default_macro_displayAtoms;this.macro_displayBonds=c.default_macro_displayBonds;this.macro_atomToLigandDistance=c.default_macro_atomToLigandDistance;this.nucleics_display=c.default_nucleics_display;this.nucleics_tubeColor=
c.default_nucleics_tubeColor;this.nucleics_baseColor=c.default_nucleics_baseColor;this.nucleics_useShapelyColors=c.default_nucleics_useShapelyColors;this.nucleics_tubeThickness=c.default_nucleics_tubeThickness;this.nucleics_tubeResolution_3D=c.default_nucleics_tubeResolution_3D;this.nucleics_materialAmbientColor_3D=c.default_nucleics_materialAmbientColor_3D;this.nucleics_materialSpecularColor_3D=c.default_nucleics_materialSpecularColor_3D;this.nucleics_materialShininess_3D=c.default_nucleics_materialShininess_3D;
this.macro_showWater=c.default_macro_showWater;this.macro_colorByChain=c.default_macro_colorByChain;this.surfaces_display=c.default_surfaces_display;this.surfaces_style=c.default_surfaces_style;this.surfaces_color=c.default_surfaces_color;this.surfaces_materialAmbientColor_3D=c.default_surfaces_materialAmbientColor_3D;this.surfaces_materialSpecularColor_3D=c.default_surfaces_materialSpecularColor_3D;this.surfaces_materialShininess_3D=c.default_surfaces_materialShininess_3D;this.crystals_displayUnitCell=
c.default_crystals_displayUnitCell;this.crystals_unitCellColor=c.default_crystals_unitCellColor;this.crystals_unitCellLineWidth=c.default_crystals_unitCellLineWidth;this.plots_color=c.default_plots_color;this.plots_width=c.default_plots_width;this.plots_showIntegration=c.default_plots_showIntegration;this.plots_integrationColor=c.default_plots_integrationColor;this.plots_integrationLineWidth=c.default_plots_integrationLineWidth;this.plots_showGrid=c.default_plots_showGrid;this.plots_gridColor=c.default_plots_gridColor;
this.plots_gridLineWidth=c.default_plots_gridLineWidth;this.plots_showYAxis=c.default_plots_showYAxis;this.plots_flipXAxis=c.default_plots_flipXAxis;this.text_font_size=c.default_text_font_size;this.text_font_families=[];a=0;for(b=c.default_text_font_families.length;a<b;a++)this.text_font_families[a]=c.default_text_font_families[a];this.text_color=c.default_text_color;this.set3DRepresentation=function(a){this.bonds_display=this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=
this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;"Ball and Stick"==a?(this.atoms_vdwMultiplier_3D=0.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=0.3,this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D):"van der Waals Spheres"==a?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"==a?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=
0.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"==a?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=0.05,this.atoms_sphereDiameter_3D=0.15,this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D):"Line"==a?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=0.05):alert('"'+a+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};
this.getFontString=function(a,b,c,f){var e=[];c&&e.push("bold ");f&&e.push("italic ");e.push(a+"px ");a=0;for(c=b.length;a<c;a++)f=b[a],-1!=f.indexOf(" ")&&(f='"'+f+'"'),e.push((0!=a?",":"")+f);return e.join("")}}})(ChemDoodle,ChemDoodle.structures,Math);
(function(c,b,a,e){a.getPointsPerAngstrom=function(){return c.default_bondLength_2D/c.default_angstromsPerBondLength};a.BondDeducer=function(){this.margin=1.1;this.deduceCovalentBonds=function(c,g){var h=a.getPointsPerAngstrom();g&&(h=g);for(var d=0,k=c.atoms.length;d<k;d++)for(var q=d+1;q<k;q++){var p=c.atoms[d],r=c.atoms[q];p.distance3D(r)<(b[p.label].covalentRadius+b[r.label].covalentRadius)*h*this.margin&&c.bonds.push(new e.Bond(p,r,1))}};return!0}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,
ChemDoodle.structures);(function(c){c.HydrogenDeducer=function(){this.removeHydrogens=function(b){for(var a=[],c=[],f=0,g=b.bonds.length;f<g;f++)"H"!=b.bonds[f].a1.label&&"H"!=b.bonds[f].a2.label&&c.push(b.bonds[f]);f=0;for(g=b.atoms.length;f<g;f++)"H"!=b.atoms[f].label&&a.push(b.atoms[f]);b.atoms=a;b.bonds=c};return!0}})(ChemDoodle.informatics);
(function(c,b,a){b.MolecularSurfaceGenerator=function(){this.generateSurface=function(b,c,g,h,d){return new a.MolecularSurface(b,c,g,h,d)};return!0}})(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures);
(function(c,b){c.Splitter=function(){this.split=function(a){for(var c=[],f=0,g=a.atoms.length;f<g;f++)a.atoms[f].visited=!1;f=0;for(g=a.bonds.length;f<g;f++)a.bonds[f].visited=!1;f=0;for(g=a.atoms.length;f<g;f++){var h=a.atoms[f];if(!h.visited){var d=new b.Molecule;d.atoms.push(h);h.visited=!0;var k=new b.Queue;for(k.enqueue(h);!k.isEmpty();)for(var h=k.dequeue(),q=0,p=a.bonds.length;q<p;q++){var r=a.bonds[q];r.contains(h)&&!r.visited&&(r.visited=!0,d.bonds.push(r),r=r.getNeighbor(h),r.visited||(r.visited=
!0,d.atoms.push(r),k.enqueue(r)))}c.push(d)}}return c};return!0}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(c,b){c.StructureBuilder=function(){this.copy=function(a){for(var c=0,f=a.atoms.length;c<f;c++)a.atoms[c].metaID=c;for(var g=new b.Molecule,c=0,f=a.atoms.length;c<f;c++)g.atoms[c]=new b.Atom(a.atoms[c].label,a.atoms[c].x,a.atoms[c].y,a.atoms[c].z);c=0;for(f=a.bonds.length;c<f;c++)g.bonds[c]=new b.Bond(g.atoms[a.bonds[c].a1.metaID],g.atoms[a.bonds[c].a2.metaID],a.bonds[c].bondOrder);return g};return!0}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(c){c._Counter=function(){this.value=0;this.molecule=null;this.setMolecule=function(b){this.value=0;this.molecule=b;this.innerCalculate&&this.innerCalculate()};return!0}})(ChemDoodle.informatics);(function(c){c.FrerejacqueNumberCounter=function(b){this.setMolecule(b);return!0};c.FrerejacqueNumberCounter.prototype=new c._Counter;c.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new c.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(c,b){b.NumberOfMoleculesCounter=function(a){this.setMolecule(a);return!0};b.NumberOfMoleculesCounter.prototype=new b._Counter;b.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var a=0,b=this.molecule.atoms.length;a<b;a++)this.molecule.atoms[a].visited=!1;a=0;for(b=this.molecule.atoms.length;a<b;a++)if(!this.molecule.atoms[a].visited){this.value++;var f=new c.Queue;this.molecule.atoms[a].visited=!0;for(f.enqueue(this.molecule.atoms[a]);!f.isEmpty();)for(var g=f.dequeue(),
h=0,d=this.molecule.bonds.length;h<d;h++){var k=this.molecule.bonds[h];k.contains(g)&&(k=k.getNeighbor(g),k.visited||(k.visited=!0,f.enqueue(k)))}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(c,b){c._RingFinder=function(){this.rings=this.bonds=this.atoms=null;this.reduce=function(a){for(var b=0,c=a.atoms.length;b<c;b++)a.atoms[b].visited=!1;b=0;for(c=a.bonds.length;b<c;b++)a.bonds[b].visited=!1;for(var g=!0;g;){g=!1;b=0;for(c=a.atoms.length;b<c;b++){for(var h=0,d=null,k=0,q=a.bonds.length;k<q;k++)if(a.bonds[k].contains(a.atoms[b])&&!a.bonds[k].visited){h++;if(2==h)break;d=a.bonds[k]}1==h&&(g=!0,d.visited=!0,a.atoms[b].visited=!0)}}b=0;for(c=a.atoms.length;b<c;b++)a.atoms[b].visited||
this.atoms.push(a.atoms[b]);b=0;for(c=a.bonds.length;b<c;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0==this.bonds.length&&0!=this.atoms.length&&(this.atoms=[])};this.setMolecule=function(a){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(a);2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()};this.fuse=function(){for(var a=0,c=this.rings.length;a<c;a++)for(var f=0,g=this.bonds.length;f<g;f++)-1!=b(this.bonds[f].a1,this.rings[a].atoms)&&-1!=b(this.bonds[f].a2,this.rings[a].atoms)&&
this.rings[a].bonds.push(this.bonds[f])};return!0}})(ChemDoodle.informatics,jQuery.inArray);
(function(c,b,a){function e(c,g){this.atoms=[];if(g)for(var h=0,d=g.atoms.length;h<d;h++)this.atoms[h]=g.atoms[h];this.atoms.push(c);this.grow=function(b,c){for(var d=this.atoms[this.atoms.length-1],f=[],g=0,h=b.length;g<h;g++)if(b[g].contains(d)){var j=b[g].getNeighbor(d);-1==a(j,c)&&f.push(j)}d=[];g=0;for(h=f.length;g<h;g++)d.push(new e(f[g],this));return d};this.check=function(c,d,f){for(var e=0,g=d.atoms.length-1;e<g;e++)if(-1!=a(d.atoms[e],this.atoms))return null;var h=null;if(d.atoms[d.atoms.length-
1]==this.atoms[this.atoms.length-1]){h=new b.Ring;h.atoms[0]=f;e=0;for(g=this.atoms.length;e<g;e++)h.atoms.push(this.atoms[e]);for(e=d.atoms.length-2;0<=e;e--)h.atoms.push(d.atoms[e])}else{for(var j=[],e=0,g=c.length;e<g;e++)c[e].contains(d.atoms[d.atoms.length-1])&&j.push(c[e]);e=0;for(g=j.length;e<g;e++)if((1==d.atoms.length||!j[e].contains(d.atoms[d.atoms.length-2]))&&j[e].contains(this.atoms[this.atoms.length-1])){h=new b.Ring;h.atoms[0]=f;c=0;for(f=this.atoms.length;c<f;c++)h.atoms.push(this.atoms[c]);
for(c=d.atoms.length-1;0<=c;c--)h.atoms.push(d.atoms[c]);break}}return h};return!0}c.EulerFacetRingFinder=function(a){this.fingerBreak=5;this.setMolecule(a);return!0};c.EulerFacetRingFinder.prototype=new c._RingFinder;c.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var b=0,c=this.atoms.length;b<c;b++){for(var h=[],d=0,k=this.bonds.length;d<k;d++)this.bonds[d].contains(this.atoms[b])&&h.push(this.bonds[d].getNeighbor(this.atoms[b]));d=0;for(k=h.length;d<k;d++)for(var q=d+1;q<h.length;q++){var p=
[];p[0]=new e(h[d]);p[1]=new e(h[q]);var r=[];r[0]=this.atoms[b];for(var l=0,m=h.length;l<m;l++)l!=d&&l!=q&&r.push(h[l]);var j=[];for((l=p[0].check(this.bonds,p[1],this.atoms[b]))&&(j[0]=l);0==j.length&&0<p.length&&p[0].atoms.length<this.fingerBreak;){for(var t=[],l=0,m=p.length;l<m;l++)for(var u=p[l].grow(this.bonds,r),n=0,w=u.length;n<w;n++)t.push(u[n]);p=t;l=0;for(m=p.length;l<m;l++)for(n=l+1;n<m;n++)(w=p[l].check(this.bonds,p[n],this.atoms[b]))&&j.push(w);if(0==j.length){t=[];l=0;for(m=r.length;l<
m;l++){n=0;for(w=this.bonds.length;n<w;n++)this.bonds[n].contains(r[l])&&(h=this.bonds[n].getNeighbor(r[l]),-1==a(h,r)&&-1==a(h,t)&&t.push(h))}l=0;for(m=t.length;l<m;l++)r.push(t[l])}}if(0<j.length){p=null;l=0;for(m=j.length;l<m;l++)if(!p||p.atoms.length>j[l].atoms.length)p=j[l];j=!1;l=0;for(m=this.rings.length;l<m;l++){r=!0;n=0;for(w=p.atoms.length;n<w;n++)if(-1==a(p.atoms[n],this.rings[l].atoms)){r=!1;break}if(r){j=!0;break}}j||this.rings.push(p)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures,
jQuery.inArray);
(function(c){c.SSSRFinder=function(b){this.rings=[];if(0<b.atoms.length){var a=(new c.FrerejacqueNumberCounter(b)).value,e=(new c.EulerFacetRingFinder(b)).rings;e.sort(function(a,b){return a.atoms.length-b.atoms.length});for(var f=0,g=b.bonds.length;f<g;f++)b.bonds[f].visited=!1;f=0;for(g=e.length;f<g;f++){for(var b=!1,h=0,d=e[f].bonds.length;h<d;h++)if(!e[f].bonds[h].visited){b=!0;break}if(b){h=0;for(d=e[f].bonds.length;h<d;h++)e[f].bonds[h].visited=!0;this.rings.push(e[f])}if(this.rings.length==a)break}}return!0}})(ChemDoodle.informatics);
(function(c,b,a,e,f,g,h,d){var k=/\s+/g,q=/\(|\)|\s+/g,p=/\'|\s+/g,r=/,|\'|\s+/g,l=/[0-9]/g,m={P:[],A:[[0,0.5,0.5]],B:[[0.5,0,0.5]],C:[[0.5,0.5,0]],I:[[0.5,0.5,0.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,0.5,0.5],[0.5,0,0.5],[0.5,0.5,0]]},j=function(a){var b=0,c=0,d=0,f=0,e=a.indexOf("x"),g=a.indexOf("y"),j=a.indexOf("z");-1!=e&&(c++,0<e&&"+"!=a.charAt(e-1)&&(c*=-1));-1!=g&&(d++,0<g&&"+"!=a.charAt(g-1)&&(d*=-1));-1!=j&&(f++,0<j&&"+"!=
a.charAt(j-1)&&(f*=-1));if(2<a.length){e="+";g=0;for(j=a.length;g<j;g++){var p=a.charAt(g);if(("-"==p||"/"==p)&&(g==a.length-1||a.charAt(g+1).match(l)))e=p;p.match(l)&&("+"==e?b+=parseInt(p):"-"==e?b-=parseInt(p):"/"==e&&(b/=parseInt(p)))}}return[b,c,d,f]};a.CIFInterpreter=function(){this.read=function(a,h,t,v){var h=h?h:1,t=t?t:1,v=v?v:1,x=new e.Molecule;if(null==a||0==a.length)return x;for(var A=a.split("\n"),D=0,C=0,B=0,G=0,J=0,F=0,z="P",H=a=null,E=null,M=!0;0<A.length;)if(M?E=A.shift():M=!0,0<
E.length)if(b.stringStartsWith(E,"_cell_length_a"))D=parseFloat(E.split(q)[1]);else if(b.stringStartsWith(E,"_cell_length_b"))C=parseFloat(E.split(q)[1]);else if(b.stringStartsWith(E,"_cell_length_c"))B=parseFloat(E.split(q)[1]);else if(b.stringStartsWith(E,"_cell_angle_alpha"))G=f.PI*parseFloat(E.split(q)[1])/180;else if(b.stringStartsWith(E,"_cell_angle_beta"))J=f.PI*parseFloat(E.split(q)[1])/180;else if(b.stringStartsWith(E,"_cell_angle_gamma"))F=f.PI*parseFloat(E.split(q)[1])/180;else if(b.stringStartsWith(E,
"_symmetry_space_group_name_H-M"))z=E.split(p)[1];else if(b.stringStartsWith(E,"loop_")){for(var I={fields:[],lines:[]},K=!1;!b.stringStartsWith(E=A.shift(),"loop_")&&0<E.length;)if(b.stringStartsWith(E,"_")){if(K)break;I.fields=I.fields.concat(E.split(k))}else K=!0,I.lines.push(E);if(b.stringStartsWith(E,"loop_")||b.stringStartsWith(E,"_"))M=!1;-1!=d("_symmetry_equiv_pos_as_xyz",I.fields)||-1!=d("_space_group_symop_operation_xyz",I.fields)?a=I:-1!=d("_atom_site_label",I.fields)&&(H=I)}E=D;G=(f.cos(G)-
f.cos(F)*f.cos(J))/f.sin(F);G=[E,0,0,0,C*f.cos(F),C*f.sin(F),0,0,B*f.cos(J),B*G,B*f.sqrt(1-f.pow(f.cos(J),2)-G*G),0,0,0,0,1];if(null!=H){B=altLabelIndex=xIndex=yIndex=zIndex=-1;F=0;for(J=H.fields.length;F<J;F++)E=H.fields[F],"_atom_site_type_symbol"==E?B=F:"_atom_site_label"==E?altLabelIndex=F:"_atom_site_fract_x"==E?xIndex=F:"_atom_site_fract_y"==E?yIndex=F:"_atom_site_fract_z"==E&&(zIndex=F);F=0;for(J=H.lines.length;F<J;F++){E=H.lines[F];for(E=E.split(k);0==E[0].length;)E.shift();x.atoms.push(new e.Atom(E[-1==
B?altLabelIndex:B].split(l)[0],parseFloat(E[xIndex]),parseFloat(E[yIndex]),parseFloat(E[zIndex])))}}A=m[z];E=[];F=0;for(J=a.lines.length;F<J;F++){for(z=a.lines[F].split(r);0==z[0].length;)z.shift();D=j(z[0]);M=j(z[1]);I=j(z[2]);H=0;for(C=x.atoms.length;H<C;H++){var z=x.atoms[H],K=z.x*D[1]+z.y*D[2]+z.z*D[3]+D[0],N=z.x*M[1]+z.y*M[2]+z.z*M[3]+M[0],Q=z.x*I[1]+z.y*I[2]+z.z*I[3]+I[0];E.push(new e.Atom(z.label,K,N,Q));if(A)for(var B=0,O=A.length;B<O;B++){var P=A[B];E.push(new e.Atom(z.label,K+P[0],N+P[1],
Q+P[2]))}}}F=0;for(J=E.length;F<J;F++){for(z=E[F];1<=z.x;)z.x--;for(;0>z.x;)z.x++;for(;1<=z.y;)z.y--;for(;0>z.y;)z.y++;for(;1<=z.z;)z.z--;for(;0>z.z;)z.z++}a=[];F=0;for(J=E.length;F<J;F++){B=!1;z=E[F];H=0;for(C=x.atoms.length;H<C;H++)if(1.0E-4>x.atoms[H].distance3D(z)){B=!0;break}if(!B){H=0;for(C=a.length;H<C;H++)if(1.0E-4>a[H].distance3D(z)){B=!0;break}B||a.push(z)}}x.atoms=x.atoms.concat(a);a=[];for(F=0;F<h;F++)for(H=0;H<t;H++)for(B=0;B<v;B++)if(!(0==F&&0==H&&0==B)){J=0;for(E=x.atoms.length;J<E;J++)z=
x.atoms[J],a.push(new e.Atom(z.label,z.x+F,z.y+H,z.z+B))}x.atoms=x.atoms.concat(a);F=0;for(J=x.atoms.length;F<J;F++)z=x.atoms[F],a=g.multiplyVec3(G,[z.x,z.y,z.z]),z.x=a[0],z.y=a[1],z.z=a[2];(new c.informatics.BondDeducer).deduceCovalentBonds(x,1);h=[-h/2,-t/2,-v/2];x.unitCellVectors={o:g.multiplyVec3(G,h,[]),x:g.multiplyVec3(G,[h[0]+1,h[1],h[2]]),y:g.multiplyVec3(G,[h[0],h[1]+1,h[2]]),z:g.multiplyVec3(G,[h[0],h[1],h[2]+1]),xy:g.multiplyVec3(G,[h[0]+1,h[1]+1,h[2]]),xz:g.multiplyVec3(G,[h[0]+1,h[1],
h[2]+1]),yz:g.multiplyVec3(G,[h[0],h[1]+1,h[2]+1]),xyz:g.multiplyVec3(G,[h[0]+1,h[1]+1,h[2]+1])};return x}};var t=new a.CIFInterpreter;c.readCIF=function(a,b,c,d){return t.read(a,b,c,d)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3,jQuery.inArray);
(function(c,b,a,e,f){function g(a,b,c){for(var f=a.length,e="",g=0;g<b-f;g++)e+=" ";return c?a+e:e+a}a.MOLInterpreter=function(){this.read=function(a,f){f||(f=c.default_bondLength_2D);var g=new e.Molecule;if(null==a||0==a.length)return g;for(var p=a.split("\n"),h=p[3],l=parseInt(h.substring(0,3)),h=parseInt(h.substring(3,6)),m=0;m<l;m++){var j=p[4+m];g.atoms[m]=new e.Atom(j.substring(31,34),parseFloat(j.substring(0,10))*f,(1==f?1:-1)*parseFloat(j.substring(10,20))*f,parseFloat(j.substring(20,30))*
f);var t=parseInt(j.substring(34,36));0!=t&&null!=b[g.atoms[m].label]&&(g.atoms[m].mass=b[g.atoms[m].label].mass+t);switch(parseInt(j.substring(36,39))){case 1:g.atoms[m].charge=3;break;case 2:g.atoms[m].charge=2;break;case 3:g.atoms[m].charge=1;break;case 5:g.atoms[m].charge=-1;break;case 6:g.atoms[m].charge=-2;break;case 7:g.atoms[m].charge=-3}}for(m=0;m<h;m++){var j=p[4+l+m],u=parseInt(j.substring(6,9)),t=parseInt(j.substring(9,12));if(3<u)switch(u){case 4:u=1.5;break;default:u=1}j=new e.Bond(g.atoms[parseInt(j.substring(0,
3))-1],g.atoms[parseInt(j.substring(3,6))-1],u);switch(t){case 3:j.stereo=e.Bond.STEREO_AMBIGUOUS;break;case 1:j.stereo=e.Bond.STEREO_PROTRUDING;break;case 6:j.stereo=e.Bond.STEREO_RECESSED}g.bonds[m]=j}return g};this.write=function(a){var h;h="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"+g(a.atoms.length.toString(),3)+g(a.bonds.length.toString(),3)+"  0  0  0  0            999 v2000\n";for(var q=a.getCenter(),p=0,r=a.atoms.length;p<r;p++){var l=a.atoms[p],m=" 0";if(-1!=
l.mass&&null!=b[l.label]){var j=l.mass-b[l.label].mass;5>j&&-4<j&&(m=(-1<j?" ":"")+j)}j="  0";if(0!=l.charge)switch(l.charge){case 3:j="  1";break;case 2:j="  2";break;case 1:j="  3";break;case -1:j="  5";break;case -2:j="  6";break;case -3:j="  7"}h=h+g(((l.x-q.x)/c.default_bondLength_2D).toFixed(4),10)+g((-(l.y-q.y)/c.default_bondLength_2D).toFixed(4),10)+g((l.z/c.default_bondLength_2D).toFixed(4),10)+" "+g(l.label,3,!0)+m+j+"  0  0  0  0\n"}p=0;for(r=a.bonds.length;p<r;p++)q=a.bonds[p],l=0,q.stereo==
e.Bond.STEREO_AMBIGUOUS?l=3:q.stereo==e.Bond.STEREO_PROTRUDING?l=1:q.stereo==e.Bond.STEREO_RECESSED&&(l=6),h=h+g((f(q.a1,a.atoms)+1).toString(),3)+g((f(q.a2,a.atoms)+1).toString(),3)+g(q.bondOrder.toString(),3)+"  "+l+"     0  0\n";return h+"M  END"}};var h=new a.MOLInterpreter;c.readMOL=function(a,b){return h.read(a,b)};c.writeMOL=function(a){return h.write(a)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
(function(c,b,a,e,f){a.PDBInterpreter=function(){function a(b,c,f,e,g){for(var h=0,m=c.length;h<m;h++){var j=c[h];if(j.id==f&&e>=j.start&&e<=j.end){g?b.helix=!0:b.sheet=!0;e+1==j.end&&(b.arrow=!0);break}}}this.calculateRibbonDistances=!1;this.read=function(d,g){var q=new e.Molecule;q.chains=[];if(null==d||0==d.length)return q;var p=d.split("\n");g||(g=1);for(var r=[],l=[],m=null,j=[],t=0,u=p.length;t<u;t++){var n=p[t];if(b.stringStartsWith(n,"HELIX"))r.push({id:n.substring(19,20),start:parseInt(n.substring(21,
25)),end:parseInt(n.substring(33,37))});else if(b.stringStartsWith(n,"SHEET"))l.push({id:n.substring(21,22),start:parseInt(n.substring(22,26)),end:parseInt(n.substring(33,37))});else if(b.stringStartsWith(n,"ATOM")){var w=n.substring(16,17);if(" "==w||"A"==w){w=f(n.substring(76,78));if(0==w.length){var v=f(n.substring(12,14));"HD"==v?w="H":0<v.length&&(w=1<v.length?v.charAt(0)+v.substring(1).toLowerCase():v)}w=new e.Atom(w,parseFloat(n.substring(30,38))*g,parseFloat(n.substring(38,46))*g,parseFloat(n.substring(46,
54))*g);w.hetatm=!1;q.atoms.push(w);v=parseInt(n.substring(22,26));if(0==j.length)for(var x=0;2>x;x++){var A=new e.Residue(-1);A.cp1=w;A.cp2=w;j.push(A)}v!=Number.NaN&&j[j.length-1].resSeq!=v&&(x=new e.Residue(v),x.name=f(n.substring(17,20)),3==x.name.length?x.name=x.name.substring(0,1)+x.name.substring(1).toLowerCase():2==x.name.length&&"D"==x.name.charAt(0)&&(x.name=x.name.substring(1)),j.push(x),A=n.substring(21,22),a(x,r,A,v,!0),a(x,l,A,v,!1));n=f(n.substring(12,16));v=j[j.length-1];if("CA"==
n||"P"==n||"O5'"==n)v.cp1||(v.cp1=w);else if("N3"==n&&("C"==v.name||"U"==v.name||"T"==v.name)||"N1"==n&&("A"==v.name||"G"==v.name))v.cp3=w;else if("C2"==n)v.cp4=w;else if("C4"==n&&("C"==v.name||"U"==v.name||"T"==v.name)||"C6"==n&&("A"==v.name||"G"==v.name))v.cp5=w;else if("O"==n||"C6"==n&&("C"==v.name||"U"==v.name||"T"==v.name)||"N9"==n){if(!j[j.length-1].cp2){if("C6"==n||"N9"==n)m=w;v.cp2=w}}else"C"==n&&(m=w)}}else if(b.stringStartsWith(n,"HETATM"))w=f(n.substring(76,78)),1<w.length&&(w=w.substring(0,
1)+w.substring(1).toLowerCase()),w=new e.Atom(w,parseFloat(n.substring(30,38))*g,parseFloat(n.substring(38,46))*g,parseFloat(n.substring(46,54))*g),w.hetatm=!0,"HOH"==f(n.substring(17,20))&&(w.isWater=!0),q.atoms.push(w);else if(b.stringStartsWith(n,"TER"))this.endChain(q,j,m),j=[];else if(b.stringStartsWith(n,"ENDMDL"))break}this.endChain(q,j,m);(new c.informatics.BondDeducer).deduceCovalentBonds(q,g);this.calculateRibbonDistances&&this.calculateDistances(q);return q};this.endChain=function(a,b,
c){if(0<b.length){var f=b[b.length-1];f.cp1||(f.cp1=a.atoms[a.atoms.length-2]);f.cp2||(f.cp2=a.atoms[a.atoms.length-1]);for(f=0;4>f;f++){var g=new e.Residue(-1);g.cp1=c;g.cp2=b[b.length-1].cp2;b.push(g)}a.chains.push(b)}};this.calculateDistances=function(a){for(var b=[],c=[],f=0,e=a.atoms.length;f<e;f++){var g=a.atoms[f];g.hetatm?g.isWater||b.push(g):c.push(g)}f=0;for(e=c.length;f<e;f++)if(g=c[f],g.closestDistance=Number.POSITIVE_INFINITY,0==b.length)g.closestDistance=0;else for(var a=0,h=b.length;a<
h;a++)g.closestDistance=Math.min(g.closestDistance,g.distance3D(b[a]))}};var g=new a.PDBInterpreter;c.readPDB=function(a,b){return g.read(a,b)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
(function(c,b,a,e,f,g){var h={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},d={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},k={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};a.JCAMPInterpreter=function(){this.convertHZ2PPM=!1;this.read=function(a){this.isBreak=function(a){return null!=h[a]||null!=d[a]||null!=k[a]||" "==a||"-"==a||"+"==a};this.getValue=function(a,b){var c=a.charAt(0),f=a.substring(1);return null!=h[c]?parseFloat(h[c]+
f):null!=d[c]?parseFloat(d[c]+f)+b:parseFloat(f)};var c=new e.Spectrum;if(null==a||0==a.length)return c;for(var a=a.split("\n"),l=[],m,j,q,u,n=1,w=1,v=1,x=-1,A=-1,D=-1,C=!0,B=!1,G=0,J=a.length;G<J;G++){var F=g(a[G]),z=f.inArray("$$",F);-1!=z&&(F=F.substring(0,z));if(0==l.length||!b.stringStartsWith(a[G],"##"))0!=l.length&&l.push("\n"),l.push(g(F));else if(z=l.join(""),C&&100>z.length&&c.metadata.push(z),l=[F],b.stringStartsWith(z,"##TITLE="))c.title=g(z.substring(8));else if(b.stringStartsWith(z,
"##XUNITS="))c.xUnit=g(z.substring(9)),this.convertHZ2PPM&&"HZ"==c.xUnit.toUpperCase()&&(c.xUnit="PPM",B=!0);else if(b.stringStartsWith(z,"##YUNITS="))c.yUnit=g(z.substring(9));else if(!b.stringStartsWith(z,"##XYPAIRS="))if(b.stringStartsWith(z,"##FIRSTX="))j=parseFloat(g(z.substring(9)));else if(b.stringStartsWith(z,"##LASTX="))m=parseFloat(g(z.substring(8)));else if(b.stringStartsWith(z,"##FIRSTY="))q=parseFloat(g(z.substring(9)));else if(b.stringStartsWith(z,"##NPOINTS="))u=parseFloat(g(z.substring(10)));
else if(b.stringStartsWith(z,"##XFACTOR="))n=parseFloat(g(z.substring(10)));else if(b.stringStartsWith(z,"##YFACTOR="))w=parseFloat(g(z.substring(10)));else if(b.stringStartsWith(z,"##DELTAX="))x=parseFloat(g(z.substring(9)));else if(b.stringStartsWith(z,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(v=parseFloat(g(z.substring(21))));else if(b.stringStartsWith(z,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(D=z.substring(19).split(","),A=parseInt(g(D[2])),D=parseFloat(g(D[3])));else if(b.stringStartsWith(z,
"##XYDATA=")){B||(v=1);var F=C=!1,z=z.split("\n"),H=(m-j)/(u-1);if(-1!=x)for(var E=1,M=z.length;E<M;E++)if("|"==z[E].charAt(0)){H=x;break}for(var I=j-H,K=q,N=0,Q,E=1,M=z.length;E<M;E++){for(var O=[],I=g(z[E]),l=[],P=!1,L=0,R=I.length;L<R;L++)this.isBreak(I.charAt(L))?(0<l.length&&!(1==l.length&&" "==l[0])&&O.push(l.join("")),l=[I.charAt(L)]):"|"==I.charAt(L)?P=!0:l.push(I.charAt(L));O.push(l.join(""));I=parseFloat(O[0])*n-H;L=1;for(R=O.length;L<R;L++)if(K=O[L],null!=k[K.charAt(0)])for(var U=parseInt(k[K.charAt(0)]+
K.substring(1))-1,T=0;T<U;T++)I+=H,N=this.getValue(Q,N),K=N*w,S++,c.data[c.data.length-1]=new e.Point(I/v,K);else null!=h[K.charAt(0)]&&F?(K=this.getValue(K,N)*w,P&&(I+=H,c.data.push(new e.Point(I/v,K)))):(F=null!=d[K.charAt(0)],Q=K,I+=H,N=this.getValue(K,N),K=N*w,S++,c.data.push(new e.Point(I/v,K)))}if(-1!=A){F=D-c.data[A-1].x;G=0;for(J=c.data.length;G<J;G++)c.data[G].x+=F}}else if(b.stringStartsWith(z,"##PEAK TABLE=")){C=!1;c.continuous=!1;for(var z=z.split("\n"),S=0,E=1,M=z.length;E<M;E++){F=z[E].split(/[\s,]+/);
S+=F.length/2;L=0;for(R=F.length;L+1<R;L+=2)c.data.push(new e.Point(parseFloat(g(F[L])),parseFloat(g(F[L+1]))))}}}c.setup();return c}};var q=new a.JCAMPInterpreter;q.convertHZ2PPM=!0;c.readJCAMP=function(a){return q.read(a)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(c,b,a){c.fromJSONChains=function(a){for(var c=[],g=0,h=a.cs.length;g<h;g++){for(var d=a.cs[g],k=[],q=0,p=d.length;q<p;q++){var r=d[q],l=new b.Residue;l.name=r.n;l.cp1=new b.Atom("",r.x1,r.y1,r.z1);l.cp2=new b.Atom("",r.x2,r.y2,r.z2);r.x3&&(l.cp3=new b.Atom("",r.x3,r.y3,r.z3),l.cp4=new b.Atom("",r.x4,r.y4,r.z4),l.cp5=new b.Atom("",r.x5,r.y5,r.z5));l.helix=r.h;l.sheet=r.s;l.arrow=r.a;k.push(l)}c.push(k)}return c};c.fromJSONPDB=function(a){var b=c.fromJSONDummy(a.mol);b.findRings=!1;b.fromJSON=
!0;b.chains=c.fromJSONChains(a.ribbons);return b};c.fromJSONDummy=function(a){for(var c=new b.Molecule,g=0,h=a.a.length;g<h;g++){var d=a.a[g],k=new b.Atom(d.l?d.l:"C",d.x,d.y);d.z&&(k.z=d.z);d.c&&(k.charge=d.c);d.m&&(k.mass=d.m);void 0!=d.p_h&&(k.hetatm=d.p_h);void 0!=d.p_w&&(k.isWater=d.p_w);void 0!=d.p_d&&(k.closestDistance=d.p_d);c.atoms.push(k)}g=0;for(h=a.b.length;g<h;g++)d=a.b[g],k=new b.Bond(c.atoms[d.b],c.atoms[d.e],d.o?d.o:1),d.s&&(k.stereo=d.s),c.bonds.push(k);return c};c.toJSONDummy=function(c){for(var f=
{a:[],b:[]},g=0,h=c.atoms.length;g<h;g++){var d=c.atoms[g];f.a[g]={x:d.x,y:d.y};"C"!=d.label&&(f.a[g].l=d.label);0!=d.z&&(f.a[g].z=d.z);0!=d.charge&&(f.a[g].c=d.charge);-1!=d.mass&&(f.a[g].m=d.mass)}g=0;for(h=c.bonds.length;g<h;g++)if(d=c.bonds[g],f.b[g]={b:a(d.a1,c.atoms),e:a(d.a2,c.atoms)},1!=d.bondOrder&&(f.b[g].o=d.bondOrder),d.stereo!=b.Bond.STEREO_NONE)f.b[g].s=d.stereo;return f}})(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
(function(c,b,a,e,f,g){e.XYZInterpreter=function(){this.deduceCovalentBonds=!0;this.read=function(b){var e=new f.Molecule;if(null==b||0==b.length)return e;for(var b=b.split("\n"),h=parseInt(g(b[0])),p=0;p<h;p++){var r=b[p+2].split(/\s+/g);e.atoms[p]=new f.Atom(isNaN(r[0])?r[0]:a[parseInt(r[0])-1],parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]))}this.deduceCovalentBonds&&(new c.informatics.BondDeducer).deduceCovalentBonds(e,1);return e}};var h=new e.XYZInterpreter;c.readXYZ=function(a){return h.read(a)}})(ChemDoodle,
ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
ChemDoodle.monitor=function(c,b,a){var e={CANVAS_DRAGGING:null,CANVAS_OVER:null,ALT:!1,SHIFT:!1,META:!1};c.supports_touch()||b(a).ready(function(){b(a).mousemove(function(a){null!=e.CANVAS_DRAGGING&&e.CANVAS_DRAGGING.drag&&(e.CANVAS_DRAGGING.prehandleEvent(a),e.CANVAS_DRAGGING.drag(a))});b(a).mouseup(function(a){null!=e.CANVAS_DRAGGING&&e.CANVAS_DRAGGING!=e.CANVAS_OVER&&e.CANVAS_DRAGGING.mouseup&&(e.CANVAS_DRAGGING.prehandleEvent(a),e.CANVAS_DRAGGING.mouseup(a));e.CANVAS_DRAGGING=null});b(a).keydown(function(a){e.SHIFT=
a.shiftKey;e.ALT=a.altKey;e.META=a.metaKey;var b=e.CANVAS_OVER;null!=e.CANVAS_DRAGGING&&(b=e.CANVAS_DRAGGING);null!=b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))});b(a).keypress(function(a){var b=e.CANVAS_OVER;null!=e.CANVAS_DRAGGING&&(b=e.CANVAS_DRAGGING);null!=b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))});b(a).keyup(function(a){e.SHIFT=a.shiftKey;e.ALT=a.altKey;e.META=a.metaKey;var b=e.CANVAS_OVER;null!=e.CANVAS_DRAGGING&&(b=e.CANVAS_DRAGGING);null!=b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})});
return e}(ChemDoodle.featureDetection,jQuery,document);
(function(c,b,a,e,f,g,h,d,k){c._Canvas=function(){this.image=this.emptyMessage=this.molecule=null;return!0};c._Canvas.prototype.repaint=function(){var a=d.getElementById(this.id);if(a.getContext){var b=a.getContext("2d"),c=k.devicePixelRatio?k.devicePixelRatio:1;1!=c&&(a.width=this.width*c,a.height=this.height*c,b.scale(c,c));null==this.image?null!=this.specs.backgroundColor&&(b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height)):b.drawImage(this.image,0,0);this.innerRepaint?
this.innerRepaint(b):null!=this.molecule&&0<this.molecule.atoms.length?(b.save(),b.translate(this.width/2,this.height/2),b.rotate(this.specs.rotateAngle),b.scale(this.specs.scale,this.specs.scale),b.translate(-this.width/2,-this.height/2),this.molecule.draw(b,this.specs),b.restore()):null!=this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&
this.drawChildExtras(b)}};c._Canvas.prototype.resize=function(a,b){var c=f("#"+this.id);c.attr({width:a,height:b});c.css("width",a);c.css("height",b);this.width=a;this.height=b;this instanceof ChemDoodle._Canvas3D?(this.gl.viewport(0,0,a,b),this.setupScene()):this.molecule&&(this.center(),this.molecule.check());this.repaint()};c._Canvas.prototype.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()};this.image.src=a};c._Canvas.prototype.loadMolecule=
function(a){this.molecule=a;this.center();this instanceof ChemDoodle._Canvas3D||this.molecule.check();this.afterLoadMolecule&&this.afterLoadMolecule();this.repaint()};c._Canvas.prototype.center=function(){var a=this.molecule.getCenter3D(),b=new e.Atom("C",this.width/2,this.height/2,0);b.sub3D(a);for(var a=0,c=this.molecule.atoms.length;a<c;a++)this.molecule.atoms[a].add3D(b);b=this.molecule.getDimension();this.specs.scale=1;if(b.x>this.width||b.y>this.height)this.specs.scale=0.85*h.min(this.width/
b.x,this.height/b.y)};c._Canvas.prototype.create=function(h,p,k){this.id=h;this.width=p;this.height=k;if(d.getElementById(h)){var l=f("#"+h);p?l.attr("width",p):this.width=l.attr("width");k?l.attr("height",k):this.height=l.attr("height")}else!c.featureDetection.supports_canvas_text()&&g.msie&&"6"<=g.version?d.writeln('<div style="border: 1px solid black;" width="'+p+'" height="'+k+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>'):
d.writeln('<canvas class="ChemDoodleWebComponent" id="'+h+'" width="'+p+'" height="'+k+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>');h=f("#"+h);h.css("width",this.width);h.css("height",this.height);this.specs=new e.VisualSpecifications;var m=this;b.supports_touch()?(h.bind("touchstart",function(a){var b=(new Date).getTime();m.lastTouch&&1==a.originalEvent.touches.length&&500>b-m.lastTouch?m.dbltap?(m.prehandleEvent(a),m.dbltap(a)):m.dblclick?(m.prehandleEvent(a),
m.dblclick(a)):m.touchstart?(m.prehandleEvent(a),m.touchstart(a)):m.mousedown&&(m.prehandleEvent(a),m.mousedown(a)):m.touchstart?(m.prehandleEvent(a),m.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){m.touchhold(a)},1E3))):m.mousedown&&(m.prehandleEvent(a),m.mousedown(a));m.lastTouch=b}),h.bind("touchmove",function(a){null!=this.hold&&(clearTimeout(this.hold),this.hold=null);if(1<a.originalEvent.touches.length&&m.multitouchmove){var b=a.originalEvent.touches.length;
m.prehandleEvent(a);for(var c=new e.Point(-a.offset.left*b,-a.offset.top*b),d=0;d<b;d++)c.x+=a.originalEvent.changedTouches[d].pageX,c.y+=a.originalEvent.changedTouches[d].pageY;c.x/=b;c.y/=b;a.p=c;m.multitouchmove(a,b)}else m.touchmove?(m.prehandleEvent(a),m.touchmove(a)):m.drag&&(m.prehandleEvent(a),m.drag(a))}),h.bind("touchend",function(a){null!=this.hold&&(clearTimeout(this.hold),this.hold=null);m.touchend?(m.prehandleEvent(a),m.touchend(a)):m.mouseup&&(m.prehandleEvent(a),m.mouseup(a));250>
(new Date).getTime()-m.lastTouch&&(m.tap?(m.prehandleEvent(a),m.tap(a)):m.click&&(m.prehandleEvent(a),m.click(a)))}),h.bind("gesturestart",function(a){m.gesturestart&&(m.prehandleEvent(a),m.gesturestart(a))}),h.bind("gesturechange",function(a){m.gesturechange&&(m.prehandleEvent(a),m.gesturechange(a))}),h.bind("gestureend",function(a){m.gestureend&&(m.prehandleEvent(a),m.gestureend(a))})):(h.click(function(a){switch(a.which){case 1:m.click&&(m.prehandleEvent(a),m.click(a));break;case 2:m.middleclick&&
(m.prehandleEvent(a),m.middleclick(a));break;case 3:m.rightclick&&(m.prehandleEvent(a),m.rightclick(a))}}),h.dblclick(function(a){m.dblclick&&(m.prehandleEvent(a),m.dblclick(a))}),h.mousedown(function(b){switch(b.which){case 1:a.CANVAS_DRAGGING=m;m.mousedown&&(m.prehandleEvent(b),m.mousedown(b));break;case 2:m.middlemousedown&&(m.prehandleEvent(b),m.middlemousedown(b));break;case 3:m.rightmousedown&&(m.prehandleEvent(b),m.rightmousedown(b))}}),h.mousemove(function(b){null==a.CANVAS_DRAGGING&&m.mousemove&&
(m.prehandleEvent(b),m.mousemove(b))}),h.mouseout(function(b){a.CANVAS_OVER=null;m.mouseout&&(m.prehandleEvent(b),m.mouseout(b))}),h.mouseover(function(b){a.CANVAS_OVER=m;m.mouseover&&(m.prehandleEvent(b),m.mouseover(b))}),h.mouseup(function(a){switch(a.which){case 1:m.mouseup&&(m.prehandleEvent(a),m.mouseup(a));break;case 2:m.middlemouseup&&(m.prehandleEvent(a),m.middlemouseup(a));break;case 3:m.rightmouseup&&(m.prehandleEvent(a),m.rightmouseup(a))}}),h.mousewheel(function(a,b){m.mousewheel&&(m.prehandleEvent(a),
m.mousewheel(a,b))}));this.subCreate&&this.subCreate()};c._Canvas.prototype.getMolecule=function(){return this.molecule};c._Canvas.prototype.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY);a.preventDefault();a.offset=f("#"+this.id).offset();a.p=new e.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,
Math,document,window);
(function(c){c._AnimatorCanvas=function(b,a,c){b&&this.create(b,a,c);this.timeout=33;return!0};c._AnimatorCanvas.prototype=new c._Canvas;c._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var b=this;this.nextFrame&&(this.handle=setInterval(function(){var a=(new Date).getTime();b.nextFrame(a-b.lastTime);b.repaint();b.lastTime=a},this.timeout))};c._AnimatorCanvas.prototype.stopAnimation=function(){null!=this.handle&&(clearInterval(this.handle),this.handle=
null)};c._AnimatorCanvas.prototype.isRunning=function(){return null!=this.handle}})(ChemDoodle);
(function(c,b){c.FileCanvas=function(a,c,f,g){a&&this.create(a,c,f);form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+g+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>';b.writeln(form);this.emptyMessage="Click below to load file";this.repaint();
return!0};c.FileCanvas.prototype=new c._Canvas})(ChemDoodle,document);
(function(c){c.HyperlinkCanvas=function(b,a,c,f,g,h){b&&this.create(b,a,c);this.urlOrFunction=f;this.color=g?g:"blue";this.size=h?h:2;this.openInNewWindow=!0;this.e=this.hoverImage=null;return!0};c.HyperlinkCanvas.prototype=new c._Canvas;c.HyperlinkCanvas.prototype.drawChildExtras=function(b){null!=this.e&&(null==this.hoverImage?(b.strokeStyle=this.color,b.lineWidth=2*this.size,b.strokeRect(0,0,this.width,this.height)):b.drawImage(this.hoverImage,0,0))};c.HyperlinkCanvas.prototype.setHoverImage=function(b){this.hoverImage=
new Image;this.hoverImage.src=b};c.HyperlinkCanvas.prototype.click=function(){this.e=null;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};c.HyperlinkCanvas.prototype.mouseout=function(){this.e=null;this.repaint()};c.HyperlinkCanvas.prototype.mouseover=function(b){this.e=b;this.repaint()}})(ChemDoodle);
(function(c,b,a,e){c.MolGrabberCanvas=function(b,c,h){b&&this.create(b,c,h);c=[];c.push('<br><input type="text" id="');c.push(b);c.push('_query" size="32" value="" />');c.push("<br><nobr>");c.push('<select id="');c.push(b);c.push('_select">');c.push('<option value="chemexper">ChemExper');c.push('<option value="chemspider">ChemSpider');c.push('<option value="pubchem" selected>PubChem');c.push("</select>");c.push('<button id="');c.push(b);c.push('_submit">Show Molecule</button>');c.push("</nobr>");
e.writeln(c.join(""));var d=this;a("#"+b+"_submit").click(function(){d.search()});a("#"+b+"_query").keypress(function(a){13==a.which&&d.search()});this.emptyMessage="Enter search term below";this.repaint();return!0};c.MolGrabberCanvas.prototype=new c._Canvas;c.MolGrabberCanvas.prototype.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};c.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...";this.molecule=null;this.repaint();var c=this;b.getMoleculeFromDatabase(a("#"+
this.id+"_select").val(),a("#"+this.id+"_query").val(),function(a){c.loadMolecule(a)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,b,a){c.RotatorCanvas=function(a,c,g,h){a&&this.create(a,c,g);this.rotate3D=h;this.zIncrement=this.yIncrement=this.xIncrement=a=b.PI/15;return!0};c.RotatorCanvas.prototype=new c._AnimatorCanvas;c.RotatorCanvas.prototype.nextFrame=function(b){if(null==this.molecule)this.stopAnimation();else{var c=b/1E3;if(this.rotate3D){b=[];a.identity(b);a.rotate(b,this.xIncrement*c,[1,0,0]);a.rotate(b,this.yIncrement*c,[0,1,0]);a.rotate(b,this.zIncrement*c,[0,0,1]);for(var c=0,g=this.molecule.atoms.length;c<
g;c++){var h=this.molecule.atoms[c],d=[h.x-this.width/2,h.y-this.height/2,h.z];a.multiplyVec3(b,d);h.x=d[0]+this.width/2;h.y=d[1]+this.height/2;h.z=d[2]}c=0;for(g=this.molecule.rings.length;c<g;c++)this.molecule.rings[c].center=this.molecule.rings[c].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*c}};c.RotatorCanvas.prototype.dblclick=
function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(c){c.SlideshowCanvas=function(b,a,c){b&&this.create(b,a,c);this.molecules=[];this.curIndex=0;this.timeout=5E3;this.alpha=0;this.innerHandle=null;this.phase=0;return!0};c.SlideshowCanvas.prototype=new c._AnimatorCanvas;c.SlideshowCanvas.prototype.drawChildExtras=function(b){b.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")";b.fillRect(0,
0,this.width,this.height)};c.SlideshowCanvas.prototype.nextFrame=function(){if(0==this.molecules.length)this.stopAnimation();else{this.phase=0;var b=this,a=1;this.innerHandle=setInterval(function(){b.alpha=a/15;b.repaint();15==a&&b.breakInnerHandle();a++},33)}};c.SlideshowCanvas.prototype.breakInnerHandle=function(){null!=this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=null);if(0==this.phase){this.curIndex++;this.curIndex>this.molecules.length-1&&(this.curIndex=0);this.alpha=1;
this.loadMolecule(this.molecules[this.curIndex]);this.phase=1;var b=this,a=1;this.innerHandle=setInterval(function(){b.alpha=(15-a)/15;b.repaint();a==15&&b.breakInnerHandle();a++},33)}else 1==this.phase&&(this.alpha=0,this.repaint())};c.SlideshowCanvas.prototype.addMolecule=function(b){0==this.molecules.length&&this.loadMolecule(b);this.molecules.push(b)}})(ChemDoodle);
(function(c,b,a,e,f){c.TransformCanvas=function(a,b,c,f){a&&this.create(a,b,c);this.lastPoint=null;this.rotate3D=f;this.rotationMultMod=1.3;this.lastPinchScale=1;this.lastGestureRotate=0;return!0};c.TransformCanvas.prototype=new c._Canvas;c.TransformCanvas.prototype.mousedown=function(a){this.lastPoint=a.p};c.TransformCanvas.prototype.dblclick=function(){var b=new a.Point(this.width/2,this.height/2);b.sub(this.molecule.getCenter());for(var c=0,d=this.molecule.atoms.length;c<d;c++)this.molecule.atoms[c].add(b);
this.molecule.check();this.repaint()};c.TransformCanvas.prototype.drag=function(c){if(!this.lastPoint.multi){if(b.ALT){var h=new a.Point(c.p.x,c.p.y);h.sub(this.lastPoint);for(var d=0,k=this.molecule.atoms.length;d<k;d++)this.molecule.atoms[d].add(h);this.lastPoint=c.p;this.molecule.check()}else if(!0==this.rotate3D){h=e.max(this.width/4,this.height/4);d=(c.p.x-this.lastPoint.x)/h*this.rotationMultMod;k=-(c.p.y-this.lastPoint.y)/h*this.rotationMultMod;h=[];f.identity(h);f.rotate(h,k,[1,0,0]);f.rotate(h,
d,[0,1,0]);d=0;for(k=this.molecule.atoms.length;d<k;d++){var q=this.molecule.atoms[d],p=[q.x-this.width/2,q.y-this.height/2,q.z];f.multiplyVec3(h,p);q.x=p[0]+this.width/2;q.y=p[1]+this.height/2;q.z=p[2]}d=0;for(k=this.molecule.rings.length;d<k;d++)this.molecule.rings[d].center=this.molecule.rings[d].getCenter();this.lastPoint=c.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else h=
new a.Point(this.width/2,this.height/2),d=h.angle(this.lastPoint),this.specs.rotateAngle-=h.angle(c.p)-d,this.lastPoint=c.p;this.repaint()}};c.TransformCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};c.TransformCanvas.prototype.multitouchmove=function(b,c){if(2==c)if(this.lastPoint.multi){var d=new a.Point(b.p.x,b.p.y);d.sub(this.lastPoint);for(var f=0,e=this.molecule.atoms.length;f<e;f++)this.molecule.atoms[f].add(d);
this.lastPoint=b.p;this.lastPoint.multi=!0;this.molecule.check();this.repaint()}else this.lastPoint=b.p,this.lastPoint.multi=!0};c.TransformCanvas.prototype.gesturechange=function(b){0!=b.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=b.originalEvent.scale/this.lastPinchScale,0.01>this.specs.scale&&(this.specs.scale=0.01),this.lastPinchScale=b.originalEvent.scale);if(0!=this.lastGestureRotate-b.originalEvent.rotation){for(var c=(this.lastGestureRotate-b.originalEvent.rotation)/180*e.PI,
d=new a.Point(this.width/2,this.height/2),f=0,q=this.molecule.atoms.length;f<q;f++){var p=d.distance(this.molecule.atoms[f]),r=d.angle(this.molecule.atoms[f])+c;this.molecule.atoms[f].x=d.x+p*e.cos(r);this.molecule.atoms[f].y=d.y-p*e.sin(r)}this.lastGestureRotate=b.originalEvent.rotation;this.molecule.check()}this.repaint()};c.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);
(function(c){c.ViewerCanvas=function(b,a,c){b&&this.create(b,a,c);return!0};c.ViewerCanvas.prototype=new c._Canvas})(ChemDoodle);
(function(c){c._SpectrumCanvas=function(b,a,c){b&&this.create(b,a,c);this.spectrum=null;this.emptyMessage="No Spectrum Loaded or Recognized";this.getMolecule=this.loadMolecule=null;return!0};c._SpectrumCanvas.prototype=new c._Canvas;c._SpectrumCanvas.prototype.innerRepaint=function(b){null!=this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(b,this.specs,this.width,this.height):null!=this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",
b.fillText(this.emptyMessage,this.width/2,this.height/2))};c._SpectrumCanvas.prototype.loadSpectrum=function(b){this.spectrum=b;this.repaint()};c._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum}})(ChemDoodle,document);(function(c){c.ObserverCanvas=function(b,a,c){b&&this.create(b,a,c);return!0};c.ObserverCanvas.prototype=new c._SpectrumCanvas})(ChemDoodle);
(function(c,b,a){c.PerspectiveCanvas=function(a,b,c){a&&this.create(a,b,c);this.dragRange=null;this.rescaleYAxisOnZoom=!0;this.lastPinchScale=1;return!0};c.PerspectiveCanvas.prototype=new c._SpectrumCanvas;c.PerspectiveCanvas.prototype.mousedown=function(a){this.dragRange=new c.structures.Point(a.p.x,a.p.x)};c.PerspectiveCanvas.prototype.mouseup=function(a){null!=this.dragRange&&this.dragRange.x!=this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),
this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=null,this.repaint())};c.PerspectiveCanvas.prototype.drag=function(a){null!=this.dragRange&&(this.dragRange.multi?this.dragRange=null:(b.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())};c.PerspectiveCanvas.prototype.drawChildExtras=function(b){if(null!=this.dragRange){var c=a.min(this.dragRange.x,this.dragRange.y),g=a.max(this.dragRange.x,this.dragRange.y);
b.strokeStyle="gray";b.lineStyle=1;b.beginPath();for(b.moveTo(c,this.height/2);c<=g;c++)5>c%10?b.lineTo(c,a.round(this.height/2)):b.moveTo(c,a.round(this.height/2));b.stroke()}};c.PerspectiveCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};c.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};c.PerspectiveCanvas.prototype.multitouchmove=function(a,b){2==b&&(null==this.dragRange||
!this.dragRange.multi?(this.dragRange=new c.structures.Point(a.p.x,a.p.x),this.dragRange.multi=!0):(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x,this.dragRange.y=a.p.x,this.repaint()))};c.PerspectiveCanvas.prototype.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale;0.01>this.specs.scale&&(this.specs.scale=0.01);this.lastPinchScale=a.originalEvent.scale;this.repaint()};c.PerspectiveCanvas.prototype.gestureend=function(){this.lastPinchScale=
1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(c,b,a,e,f,g,h,d,k,q){c._Canvas3D=function(a,b,c){a&&this.create(a,b,c);this.rotationMatrix=d.identity([]);this.translationMatrix=d.identity([]);this.lastPoint=null;this.emptyMessage="WebGL is Unavailable!";return!0};c._Canvas3D.prototype=new c._Canvas;c._Canvas3D.prototype.afterLoadMolecule=function(){var a=this.molecule.getDimension();this.maxDimension=g.max(a.x,a.y);this.translationMatrix=d.translate(d.identity([]),[0,0,-this.maxDimension-10]);this.setupScene()};c._Canvas3D.prototype.setViewDistance=
function(a){this.translationMatrix=d.translate(d.identity([]),[0,0,-a])};c._Canvas3D.prototype.repaint=function(){this.gl&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=d.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,null!=this.molecule&&this.molecule.render(this.gl,this.specs),this.gl.flush())};c._Canvas3D.prototype.center=function(){h.getElementById(this.id);for(var a=this.molecule.getCenter3D(),b=0,
c=this.molecule.atoms.length;b<c;b++)this.molecule.atoms[b].sub3D(a);if(this.molecule.chains&&this.molecule.fromJSON){b=0;for(c=this.molecule.chains.length;b<c;b++)for(var d=this.molecule.chains[b],f=0,e=d.length;f<e;f++){var g=d[f];g.cp1.sub3D(a);g.cp2.sub3D(a);g.cp3&&(g.cp3.sub3D(a),g.cp4.sub3D(a),g.cp5.sub3D(a))}}};c._Canvas3D.prototype.subCreate=function(){try{var a=h.getElementById(this.id);this.gl=a.getContext("webgl");this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?
(this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new e.Shader,this.gl.shader.init(this.gl),this.setupScene()):(this.molecule=null,this.displayMessage())};c._Canvas.prototype.displayMessage=function(){var a=h.getElementById(this.id);if(a.getContext&&(a=a.getContext("2d"),null!=this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),null!=this.emptyMessage))a.fillStyle="#737683",a.textAlign="center",
a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2)};c._Canvas3D.prototype.setupScene=function(){if(this.gl){var c=a.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(c[0],c[1],c[2],1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new e.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);this.gl.starBuffer=new e.Star;this.gl.cylinderBuffer=
new e.Cylinder(1,1,this.specs.bonds_resolution_3D);this.gl.lineBuffer=new e.Line;if(this.molecule&&this.molecule!=this.previousMolecule&&(this.previousMolecule=this.molecule,this.molecule.unitCellVectors&&(this.molecule.unitCell=new e.UnitCell(this.molecule.unitCellVectors)),this.molecule.chains)){this.molecule.ribbons=[];this.molecule.cartoons=[];this.molecule.tubes=[];for(var c=0,h=this.molecule.chains.length;c<h;c++){var l=this.molecule.chains[c],m=2<l.length&&f[l[2].name]&&"#BEA06E"==f[l[2].name].aminoColor;
if(0<l.length&&!l[0].lineSegments){for(var j=0,t=l.length-1;j<t;j++)m&&(l[j].Ns=1),l[j].setup(l[j+1].cp1);if(!m){j=1;for(t=l.length-1;j<t;j++)b.vec3AngleFrom(l[j-1].D,l[j].D)>g.PI/2&&(l[j].guidePointsSmall.reverse(),l[j].guidePointsLarge.reverse(),q.scale(l[j].D,-1))}j=1;for(t=l.length-3;j<t;j++)l[j].computeLineSegments(l[j-1],l[j+1],l[j+2],!m);l.pop();l.pop();l.pop();l.shift()}var u=a.hsl2rgb(1==h?0.5:c/h,1,0.5),u="rgb("+u[0]+","+u[1]+","+u[2]+")";l.chainColor=u;if(m)l=new e.Tube(l,this.specs.nucleics_tubeThickness,
this.specs.nucleics_tubeResolution_3D),l.chainColor=u,this.molecule.tubes.push(l);else{m={front:new e.Ribbon(l,this.specs.proteins_ribbonThickness,!1),back:new e.Ribbon(l,-this.specs.proteins_ribbonThickness,!1)};m.front.chainColor=u;m.back.chainColor=u;j=0;for(t=m.front.segments.length;j<t;j++)m.front.segments[j].chainColor=u;j=0;for(t=m.back.segments.length;j<t;j++)m.back.segments[j].chainColor=u;this.molecule.ribbons.push(m);l={front:new e.Ribbon(l,this.specs.proteins_ribbonThickness,!0),back:new e.Ribbon(l,
-this.specs.proteins_ribbonThickness,!0)};l.front.chainColor=u;l.back.chainColor=u;j=0;for(t=l.front.segments.length;j<t;j++)l.front.segments[j].chainColor=u;j=0;for(t=l.back.segments.length;j<t;j++)l.back.segments[j].chainColor=u;j=0;for(t=l.front.cartoonSegments.length;j<t;j++)l.front.cartoonSegments[j].chainColor=u;j=0;for(t=l.back.cartoonSegments.length;j<t;j++)l.back.cartoonSegments[j].chainColor=u;this.molecule.cartoons.push(l)}}}this.gl.lighting=new e.Light(this.specs.lightDiffuseColor_3D,
this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);this.gl.lighting.lightScene(this.gl);this.gl.material=new e.Material(this.gl);c=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(c=this.specs.projectionWidthHeightRatio_3D);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?d.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,c,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):d.ortho(-this.specs.projectionOrthoWidth_3D/
2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/c,this.specs.projectionOrthoWidth_3D/2/c,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),!1,this.gl.projectionMatrix);var n=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),w=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(n,
false,a);a=k.transpose(d.toInverseMat3(a,[]));this.uniformMatrix3fv(w,false,a)}}};c._Canvas3D.prototype.mousedown=function(a){this.lastPoint=a.p};c._Canvas3D.prototype.rightmousedown=function(a){this.lastPoint=a.p};c._Canvas3D.prototype.drag=function(a){if(c.monitor.ALT){var b=new e.Point(a.p.x,a.p.y);b.sub(this.lastPoint);d.translate(this.translationMatrix,[b.x/20,-b.y/20,0])}else{g.max(this.width/4,this.height/4);var f=a.p.x-this.lastPoint.x,b=a.p.y-this.lastPoint.y,f=d.rotate(d.identity([]),f*
g.PI/180,[0,1,0]);d.rotate(f,b*g.PI/180,[1,0,0]);this.rotationMatrix=d.multiply(f,this.rotationMatrix)}this.lastPoint=a.p;this.repaint()};c._Canvas3D.prototype.mousewheel=function(a,b){var c=b*this.maxDimension/8;this.specs.projectionPerspective_3D?d.translate(this.translationMatrix,[0,0,c]):(this.specs.projectionOrthoWidth_3D-=c,this.setupScene());this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math,document,mat4,mat3,vec3,window);
(function(c,b,a,e){c.MolGrabberCanvas3D=function(b,c,h){b&&this.create(b,c,h);c=[];c.push('<br><input type="text" id="');c.push(b);c.push('_query" size="32" value="" />');c.push("<br><nobr>");c.push('<select id="');c.push(b);c.push('_select">');c.push('<option value="pubchem" selected>PubChem');c.push("</select>");c.push('<button id="');c.push(b);c.push('_submit">Show Molecule</button>');c.push("</nobr>");e.writeln(c.join(""));var d=this;a("#"+b+"_submit").click(function(){d.search()});a("#"+b+"_query").keypress(function(a){13==
a.which&&d.search()});return!0};c.MolGrabberCanvas3D.prototype=new c._Canvas3D;c.MolGrabberCanvas3D.prototype.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};c.MolGrabberCanvas3D.prototype.search=function(){var c=this;b.getMoleculeFromDatabase(a("#"+this.id+"_select").val(),a("#"+this.id+"_query").val(),function(a){c.loadMolecule(a)},3)}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,b){c.MovieCanvas3D=function(a,b,c){a&&this.create(a,b,c);this.timeout=50;this.molecules=[];this.frameNumber=0;this.playMode=2;this.reverse=!1;return!0};c.MovieCanvas3D.PLAY_ONCE=0;c.MovieCanvas3D.PLAY_LOOP=1;c.MovieCanvas3D.PLAY_SPRING=2;c.MovieCanvas3D.prototype=new c._Canvas3D;c.MovieCanvas3D.prototype.startAnimation=c._AnimatorCanvas.prototype.startAnimation;c.MovieCanvas3D.prototype.stopAnimation=c._AnimatorCanvas.prototype.stopAnimation;c.MovieCanvas3D.prototype.isRunning=c._AnimatorCanvas.prototype.isRunning;
c.MovieCanvas3D.prototype.dblclick=c.RotatorCanvas.prototype.dblclick;c.MovieCanvas3D.prototype.nextFrame=function(){this.molecule=this.molecules[this.frameNumber];2==this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.molecules.length&&(2==this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0==this.playMode&&this.stopAnimation())))};c.MovieCanvas3D.prototype.center=function(){var a=
this.molecule.getCenter3D(),c=new b.Atom;c.sub3D(a);for(var a=0,f=this.molecules.length;a<f;a++)for(var g=this.molecules[a],h=0,d=g.atoms.length;h<d;h++)g.atoms[h].add3D(c)}})(ChemDoodle,ChemDoodle.structures);
(function(c,b,a){c.RotatorCanvas3D=function(a,c,g){a&&this.create(a,c,g);this.timeout=33;this.zIncrement=this.yIncrement=this.xIncrement=a=b.PI/15;return!0};c.RotatorCanvas3D.prototype=new c._Canvas3D;c.RotatorCanvas3D.prototype.startAnimation=c._AnimatorCanvas.prototype.startAnimation;c.RotatorCanvas3D.prototype.stopAnimation=c._AnimatorCanvas.prototype.stopAnimation;c.RotatorCanvas3D.prototype.isRunning=c._AnimatorCanvas.prototype.isRunning;c.RotatorCanvas3D.prototype.dblclick=c.RotatorCanvas.prototype.dblclick;
c.RotatorCanvas3D.prototype.mousedown=null;c.RotatorCanvas3D.prototype.rightmousedown=null;c.RotatorCanvas3D.prototype.drag=null;c.RotatorCanvas3D.prototype.mousewheel=null;c.RotatorCanvas3D.prototype.nextFrame=function(b){if(null==this.molecule)this.stopAnimation();else{var c=[];a.identity(c);b/=1E3;a.rotate(c,this.xIncrement*b,[1,0,0]);a.rotate(c,this.yIncrement*b,[0,1,0]);a.rotate(c,this.zIncrement*b,[0,0,1]);a.multiply(this.rotationMatrix,c)}}})(ChemDoodle,Math,mat4);
(function(c){c.TransformCanvas3D=function(b,a,c){b&&this.create(b,a,c);return!0};c.TransformCanvas3D.prototype=new c._Canvas3D})(ChemDoodle);(function(c){c.ViewerCanvas3D=function(b,a,c){b&&this.create(b,a,c);return!0};c.ViewerCanvas3D.prototype=new c._Canvas3D;c.ViewerCanvas3D.prototype.mousedown=null;c.ViewerCanvas3D.prototype.rightmousedown=null;c.ViewerCanvas3D.prototype.drag=null;c.ViewerCanvas3D.prototype.mousewheel=null})(ChemDoodle);
(function(c,b,a){function e(a,b,c,d){this.element=a;this.x=b;this.y=c;this.dimension=d}c.PeriodicTableCanvas=function(a,b){this.padding=5;a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding);this.getMolecule=this.loadMolecule=null;this.cellDimension=b?b:20;this.setupTable();this.repaint();return!0};c.PeriodicTableCanvas.prototype=new c._Canvas;c.PeriodicTableCanvas.prototype.getHoveredElement=function(){return null!=this.hovered?this.hovered.element:null};c.PeriodicTableCanvas.prototype.innerRepaint=
function(a){for(var b=0,c=this.cells.length;b<c;b++)this.drawCell(a,this.specs,this.cells[b]);null!=this.hovered&&this.drawCell(a,this.specs,this.hovered);null!=this.selected&&this.drawCell(a,this.specs,this.selected)};c.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var a=y=this.padding,b=0,h=0,d=c.SYMBOLS.length;h<d;h++){18==b&&(b=0,y+=this.cellDimension,a=this.padding);var k=c.ELEMENT[c.SYMBOLS[h]];if(2==k.atomicNumber)a+=16*this.cellDimension,b+=16;else if(5==k.atomicNumber||
13==k.atomicNumber)a+=10*this.cellDimension,b+=10;if((58>k.atomicNumber||71<k.atomicNumber&&90>k.atomicNumber||103<k.atomicNumber)&&113>k.atomicNumber)this.cells.push(new e(k,a,y,this.cellDimension)),a+=this.cellDimension,b++}y+=2*this.cellDimension;a=3*this.cellDimension+this.padding;for(h=57;104>h;h++)if(k=c.ELEMENT[c.SYMBOLS[h]],90==k.atomicNumber&&(y+=this.cellDimension,a=3*this.cellDimension+this.padding),58<=k.atomicNumber&&71>=k.atomicNumber||90<=k.atomicNumber&&103>=k.atomicNumber)this.cells.push(new e(k,
a,y,this.cellDimension)),a+=this.cellDimension};c.PeriodicTableCanvas.prototype.drawCell=function(a,c,e){var d=a.createRadialGradient(e.x+e.dimension/3,e.y+e.dimension/3,1.5*e.dimension,e.x+e.dimension/3,e.y+e.dimension/3,e.dimension/10);d.addColorStop(0,"#000000");d.addColorStop(0.7,e.element.jmolColor);d.addColorStop(1,"#FFFFFF");a.fillStyle=d;b.contextRoundRect(a,e.x,e.y,e.dimension,e.dimension,e.dimension/8);if(e==this.hovered||e==this.selected)a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),
a.fillStyle="white";a.fill();a.font=c.getFontString(c.text_font_size,c.text_font_families);a.fillStyle=c.text_color;a.textAlign="center";a.textBaseline="middle";a.fillText(e.element.symbol,e.x+e.dimension/2,e.y+e.dimension/2)};c.PeriodicTableCanvas.prototype.click=function(){null!=this.hovered&&(this.selected=this.hovered,this.repaint())};c.PeriodicTableCanvas.prototype.mousemove=function(b){var c=b.p.x,b=b.p.y;this.hovered=null;for(var e=0,d=this.cells.length;e<d;e++){var k=this.cells[e];if(a.isBetween(c,
k.x,k.x+k.dimension)&&a.isBetween(b,k.y,k.y+k.dimension)){this.hovered=k;break}}this.repaint()};c.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(c,b){c._Layout=function(){return!0};c._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()};c._Layout.prototype.create=function(a){this.name=a;this.specs=new b.VisualSpecifications}})(ChemDoodle,ChemDoodle.structures);
(function(c,b,a){c.SimpleReactionLayout=function(a){this.reactants=[];this.products=[];this.textBelow=this.textAbove=null;this.arrow="&rarr;";this.plus="+";this.create(a);return!0};c.SimpleReactionLayout.prototype=new c._Layout;c.SimpleReactionLayout.prototype.addReactant=function(a){this.reactants.push(a)};c.SimpleReactionLayout.prototype.addProduct=function(a){this.products.push(a)};c.SimpleReactionLayout.prototype.innerLayout=function(){a.writeln("<table><tr>");for(var e=0,f=this.reactants.length;e<
f;e++){0<e&&a.writeln('<td><span style="font-size:25px;">'+this.plus+"</span></td>");a.writeln("<td>");var g=this.reactants[e].getDimension(),g=new c.ViewerCanvas(this.name+"_reactant"+e,g.x+60,g.y+60);null==this.specs.backgroundColor&&b("#"+this.name+"_reactant"+e).css("border","0px");g.specs=this.specs;g.loadMolecule(this.reactants[e]);a.writeln("</td>")}a.writeln("<td>");a.writeln("<table>");a.writeln("<tr><td>");null!=this.textAbove?a.writeln("<center>"+this.textAbove+"</center>"):a.writeln("&nbsp;");
a.writeln("</td></tr>");a.writeln('<tr><td><center><span style="font-size:25px;">'+this.arrow+"</span></center></td></tr>");a.writeln("<tr><td>");null!=this.textBelow?a.writeln("<center>"+this.textBelow+"</center>"):a.writeln("&nbsp;");a.writeln("</td></tr>");a.writeln("</table>");a.writeln("</td>");e=0;for(f=this.products.length;e<f;e++)0<e&&a.writeln('<td><span style="font-size:25px;">'+this.plus+"</td>"),a.writeln("<td>"),g=this.products[e].getDimension(),g=new c.ViewerCanvas(this.name+"_product"+
e,g.x+60,g.y+60),null==this.specs.backgroundColor&&b("#"+this.name+"_product"+e).css("border","0px"),g.specs=this.specs,g.loadMolecule(this.products[e]),a.writeln("</td>");a.writeln("</tr></table>")}})(ChemDoodle,jQuery,document);(function(c,b,a){c.png={};c.png.create=function(c){a.open(b.getElementById(c.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);
